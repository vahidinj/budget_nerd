@import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Source+Sans+3:wght@400;500;600&display=swap');
.cover.cover-minimal {
  position: relative;
  overflow: hidden;
  padding: 1.7rem 1.6rem 1.8rem;
  border-radius: var(--radius-lg);
  border: 1px solid var(--surface-1-border);
  background: linear-gradient(160deg, rgba(26,32,42,0.95) 0%, rgba(10,14,19,0.95) 100%);
  box-shadow: 0 1px 0 rgba(255,255,255,0.03) inset;
  font-family: var(--cover-body-font);
}
.cover.cover-minimal::before {
  content: "";
  position: absolute;
  inset: 0;
  background:
  radial-gradient(800px 320px at 12% 8%, rgba(255,179,71,0.14), transparent 60%),
  radial-gradient(560px 280px at 84% 18%, rgba(72,243,255,0.1), transparent 55%),
  repeating-linear-gradient(120deg, rgba(255,255,255,0.03) 0 1px, transparent 1px 14px);
  opacity: 0.7;
  pointer-events: none;
}
.cover.cover-minimal > * {
  position: relative;
  z-index: 1;
}
.cover-minimal .cover-global-title {
  font-family: var(--cover-display-font);
  font-size: clamp(2rem, 3.6vw, 3.1rem);
  letter-spacing: -0.02em;
  margin: 0 0 0.5rem;
  color: var(--text-strong);
}
.cover-minimal .hero-eyebrow {
  text-transform: uppercase;
  letter-spacing: 0.2em;
  font-size: 0.72rem;
  color: var(--accent);
  margin-bottom: 0.6rem;
  font-weight: 600;
}
.cover-minimal .hero-sub {
  max-width: 520px;
  font-size: 1.02rem;
  color: var(--text-base);
  line-height: 1.5;
  margin: 0 0 1.2rem;
}
.cover-minimal .hero-subline {
  display: block;
  margin-top: 0.3rem;
  color: var(--text-muted);
  font-weight: 600;
  letter-spacing: 0.01em;
}
.cover-minimal .cover-hero {
  display: grid;
  grid-template-columns: minmax(0, 1.3fr) minmax(220px, 0.7fr);
  gap: 1.4rem;
  align-items: center;
  animation: coverRise 600ms ease both;
}
.cover-minimal .hero-actions {
  display: flex;
  gap: 0.75rem;
  flex-wrap: wrap;
}
.cover-minimal .hero-stepper {
  display: flex;
  flex-direction: column;
  gap: 0.6rem;
  background: rgba(15,18,25,0.6);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 12px;
  padding: 0.9rem;
}
.cover-minimal .step-tab {
  display: flex;
  align-items: center;
  gap: 0.6rem;
  border-radius: 10px;
  border: 1px solid transparent;
  background: transparent;
  color: var(--text-base);
  padding: 0.55rem 0.7rem;
  font-size: 0.92rem;
  text-align: left;
  cursor: pointer;
  transition: background 160ms ease, border-color 160ms ease, color 160ms ease;
}
.cover-minimal .step-tab .step-num {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background: rgba(255,179,71,0.14);
  color: var(--accent);
  font-weight: 700;
}
.cover-minimal .step-tab.active {
  background: rgba(255,179,71,0.1);
  border-color: rgba(255,179,71,0.25);
  color: var(--text-strong);
}
.cover-minimal .step-tab.active .step-num {
  background: rgba(255,179,71,0.3);
}
.cover-minimal .cover-stage {
  margin-top: 1.4rem;
}
.cover-minimal .stage-panel {
  background: rgba(14,18,26,0.82);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 14px;
  padding: 1.2rem 1.3rem;
  box-shadow: 0 12px 24px -20px rgba(0,0,0,0.7);
  animation: coverFade 420ms ease both;
}
.cover-minimal .stage-title {
  font-family: var(--cover-display-font);
  font-size: 1.35rem;
  margin: 0 0 0.35rem;
}
.cover-minimal .stage-sub {
  margin: 0 0 1rem;
  color: var(--text-muted);
}
.cover-minimal .stage-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 0.9rem;
  margin-bottom: 1rem;
}
.cover-minimal .stage-card {
  background: rgba(16, 20, 28, 0.8);
  border: 1px solid rgba(255,255,255,0.04);
  border-radius: 12px;
  padding: 0.85rem 0.9rem;
  min-height: 120px;
  display: flex;
  flex-direction: column;
  gap: 0.35rem;
  cursor: default;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.03);
  animation: coverFade 520ms ease both;
}
.cover-minimal .stage-card:nth-child(2) { animation-delay: 80ms; }
.cover-minimal .stage-card:nth-child(3) { animation-delay: 140ms; }
.cover-minimal .stage-card .card-title {
  font-weight: 700;
  color: var(--accent);
  font-size: 0.75rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
}
.cover-minimal .stage-card p {
  margin: 0;
  color: var(--text-base);
  font-size: 0.94rem;
}
.cover-minimal .stage-nav {
  display: flex;
  justify-content: space-between;
  gap: 0.6rem;
  margin-top: 0.6rem;
}
.cover-minimal .ghost-cta {
  background: transparent;
  border: 1px solid rgba(255,255,255,0.1);
  color: var(--text-base);
  padding: 0.4rem 0.85rem;
  border-radius: 999px;
  font-size: 0.9rem;
}
.cover-minimal .ghost-cta:disabled {
  opacity: 0.4;
}
.cover-minimal .link-cta {
  margin: 0 0 0.75rem;
  background: none;
  border: none;
  color: var(--accent);
  font-weight: 600;
  cursor: pointer;
  padding: 0;
  text-decoration: none;
}
.cover-minimal .detail-actions {
  display: flex;
  align-items: center;
  gap: 0.9rem;
  flex-wrap: wrap;
  margin-bottom: 0.6rem;
}
.cover-minimal .detail-list {
  margin: 0 0 1rem 1rem;
  color: var(--text-muted);
  font-size: 0.92rem;
  line-height: 1.5;
}
.cover-minimal .developer-line {
  margin: 0 0 0.9rem;
  color: var(--text-muted);
  font-size: 0.9rem;
}
.cover-minimal .front-utility-row {
  display: flex;
  flex-wrap: wrap;
  gap: 0.6rem;
  margin: 0.9rem 0 0.4rem;
}
@keyframes coverRise {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes coverFade {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}
@media (max-width: 900px) {
  .cover-minimal .cover-hero {
    grid-template-columns: 1fr;
  }
  .cover-minimal .hero-stepper {
    flex-direction: row;
    justify-content: space-between;
    flex-wrap: wrap;
  }
  .cover-minimal .step-tab {
    flex: 1 1 140px;
  }
}
@media (max-width: 640px) {
  .cover.cover-minimal {
    padding: 1.3rem 1.1rem 1.4rem;
  }
  .cover-minimal .hero-actions {
    flex-direction: column;
    align-items: stretch;
  }
  .cover-minimal .stage-nav {
    flex-direction: column;
  }
}
.sp-try-btn {
  font-size: .93em;
  padding: .32em 1.1em;
  border-radius: 999px;
  margin-top: .18em;
  box-shadow: 0 1.5px 0 #ffe6a6 inset;
}
.hint-inline { margin-left:6px; font-weight:400; font-size:0.97em; }
.sankey-toggle-panel { position:absolute; top:26px; left:4px; display:flex; flex-direction:column; gap:4px; z-index:6; }
.windowed-rows-container { overflow:auto; position:relative; }
.table-empty-message { text-align:center; padding:3em 1em; color:var(--text-muted); background:var(--surface-1); border:1px solid var(--surface-1-border); border-radius:var(--panel-radius); box-shadow:0 1px 3px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.03) inset; }
.table-empty-title { font-size:1.2em; margin-bottom:.5em; color:var(--text-strong); font-weight:650; }
.table-empty-sub { font-size:0.95em; color:var(--text-base); line-height:1.4; }
.sp-pulse { mix-blend-mode: screen; }
.cover-left {
  display: flex;
  flex-direction: column;
  gap: .75rem;
}
.cover-right {
  display: flex;
  flex-direction: column;
  gap: .85rem;
}
.cover-sub-sections {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: var(--card-gap) var(--card-gap-wide);
  margin: .2rem 0 1.1rem;
}
.cover-sub-sections.merged-panels {
  margin: .1rem 0 1.2rem;
}
.cover-sub-sections h2 {
  margin: 0 0 .45rem;
  font-size: .74rem;
  letter-spacing: .11em;
  text-transform: uppercase;
  font-weight: 650;
  color: var(--accent-warm);
  background: linear-gradient(90deg, var(--accent-warm), var(--accent) 70%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}
.cover-sub-sections .use-cases, .cover-sub-sections .trust-badges {
  background: var(--surface-1);
  border: 1px solid var(--surface-1-border);
  border-radius: 10px;
  padding: .65rem .95rem .7rem .95rem;
  box-shadow: 0 1px 3px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.03) inset;
  transition: background-color 200ms ease, border-color 200ms ease, box-shadow 200ms ease;
}
.cover-sub-sections .use-cases:hover, .cover-sub-sections .trust-badges:hover {
  background: var(--surface-2);
  border-color: var(--surface-2-border);
  box-shadow: 0 4px 12px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,255,255,0.05) inset;
}
.value-grid.merged {
  background: var(--surface-1);
  border: 1px solid var(--surface-1-border);
  border-radius: 10px;
  padding: .65rem .95rem .7rem .95rem;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: var(--card-gap) var(--card-gap-wide);
  margin-bottom: .7rem;
  box-shadow: 0 1px 3px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.03) inset;
}
.value-grid .val-item {
  background: var(--surface-2);
  border: 1px solid var(--surface-2-border);
  border-radius: 8px;
  padding: .5rem .6rem .55rem .6rem;
  color: #ffe6a6;
  font-size: .91rem;
  font-weight: 600;
  box-shadow: 0 1px 2px rgba(0,0,0,0.3), 0 0 0 1px rgba(255,255,255,0.02) inset;
  transition: transform 150ms ease, box-shadow 200ms ease;
}
.value-grid .val-item:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 10px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,179,71,0.1) inset;
}
.value-grid .val-item strong {
  color: #ffb347;
  font-weight: 700;
  font-size: 1.01em;
}
/* Thematic typography refresh: adopt slightly condensed, finance-dashboard style font stack */
:root { --container-pad-y: .6rem; --container-pad-x: .9rem; 
  --card-gap: .35rem;
  --card-gap-wide: .525rem;
  --section-gap: .4rem;
  --cover-display-font: "Space Grotesk", "IBM Plex Sans", "Segoe UI", sans-serif;
  --cover-body-font: "Source Sans 3", "Segoe UI", system-ui, -apple-system, sans-serif;
  /* 3-level surface elevation system with softer borders */
  --surface-0: #0f1115;
  --surface-1: #141a22; --surface-1-border: rgba(255,255,255,0.06);
  --surface-2: #1a202a; --surface-2-border: rgba(255,255,255,0.08);
  --surface-3: #202835; --surface-3-border: rgba(255,255,255,0.1);
}
body, html { margin:0; font-family: "Inter", "Segoe UI", system-ui, -apple-system, "Roboto", "Helvetica Neue", Arial, sans-serif; background:var(--surface-0); color:#d9e2e8; font-feature-settings:"ss01","ss02","cv02","cv03"; font-variant-numeric: tabular-nums; -webkit-font-smoothing:antialiased; }
/* Fallback if Inter not loaded - optional self-host can be added later. */
/* Muted heading + supporting text adjustments */
:root { --text-strong:#e9eef1; --text-base:#c3cdd3; --text-muted:#80919d; --text-faint:#5b6974; 
  /* Newly consolidated design tokens (non-breaking) */
  --accent:#ffb347; --accent-hover:#ffd27f; --accent-warm:#ffe6a6;
  /* Upload CTA text color (dark blue matching theme) */
  --upload-cta-text: #123a6a;
  --upload-cta-text-shadow: 0 1px 0 rgba(0,0,0,0.45);
  /* Chart semantic tokens (used by Plot traces and small UI accents) */
  --chart-positive: var(--alloc-income-start);
  --chart-negative: var(--alloc-expense-start);
  --chart-accent: var(--accent);
  --chart-savings: var(--alloc-savings-start);
  --chart-savings-light: #c3e9ff;
  --chart-muted: var(--text-muted);
  --chart-category-1: #9d7ef7;
  --ai-accent: #48f3ff;
  --ai-accent-soft: rgba(72,243,255,0.14);
  --ai-accent-border: rgba(72,243,255,0.35);
  --panel-bg:#161d25; --panel-border:#24303d; --panel-bg-alt:#1b242e;
  /* Unified card surface tokens for consistent panels */
  --card-surface-bg: linear-gradient(160deg, rgba(25,33,43,0.92) 0%, rgba(12,16,22,0.95) 100%);
  --card-surface-border: rgba(255,255,255,0.08);
  --card-surface-shadow: 0 6px 12px -8px rgba(0,0,0,.7), 0 1px 0 rgba(255,255,255,.02) inset;
  /* Additional surface tokens for cover and CTAs */
  --bg-1:#131a23; --bg-2:#0f1115;
  --surface:#151c24; --surface-border:#24303d;
  --accent-soft: #ffe6a6;
  --orb-star: #ffd86b;
  /* Allocation color tokens (used by allocation bars and legends) */
  --alloc-income-start:#5ad67d; --alloc-income-end:#37b468;
  --alloc-savings-start:#4db7ff; --alloc-savings-end:#1c8ad6;
  --alloc-expense-start:#ff6b6b; --alloc-expense-end:#ff9c6b;
  --alloc-unallocated-start:#9fa6b2; --alloc-unallocated-end:#c3c9d3;
  /* Account legend segment colors (fallback to alloc tokens) */
  --acct-checking:var(--alloc-income-start);
  --acct-savings:var(--alloc-savings-start);
  --acct-credit: #6a4fa8;
  /* Error / alert tokens */
  --error-bg:#470f18; --error-color:#ffd7d7; --error-border:#ff6b6b;
  --radius-sm:6px; --radius-md:8px; --radius-lg:12px; --radius-pill:999px;
  /* Unified panel corner radius across dashboard containers */
  --panel-radius:4px;
  --focus-ring:0 0 0 2px #0f1115,0 0 0 4px var(--accent);
  --link-accent:var(--accent); --link-accent-hover:var(--accent-hover);
}

/* Compact dark overrides (can be extended for light theme) */
:root.dark {
  --surface-0: #0b0e11;
  --surface-1: #0f1418; --surface-1-border: rgba(255,255,255,0.05);
  --surface-2: #141a22; --surface-2-border: rgba(255,255,255,0.07);
  --surface-3: #1a202a; --surface-3-border: rgba(255,255,255,0.09);
  --bg-1: #0f1418;
  --bg-2: #0b0e11;
  --panel-bg: var(--surface-1);
  --panel-border: var(--surface-1-border);
  --surface: #0d1418;
  --surface-border: #1b2328;
  --accent: #ffad33;
  --accent-hover: #ffd27f;
}

/* Global text tone normalization */
p, li, .tagline, .global-tagline, .value-grid span, .sample-preview .sp-foot { color:var(--text-base); }
.muted, .cover .drop-hint, .supported-note, .cta-note, .sample-preview .sp-metrics .lbl { color:var(--text-muted) !important; }

/* Headings: slightly less saturated except hero */
h1, h2, h3, h4 { color:var(--text-strong); font-weight:650; letter-spacing:.5px; }
.cover h1.cover-global-title { filter:saturate(.92) brightness(.98); }

/* Tagline (moved) soft tone */
.global-tagline, .global-tagline.moved { color:var(--text-muted); font-weight:500; }

/* Trust & use cases panels lists a bit softer */
.trust-badges ul, .use-cases ul { color:var(--text-base); }
.trust-badges li, .use-cases li { color:var(--text-muted); }

/* Primary CTA keeps contrast; secondary & structural UI text slightly muted */
button, .btn, .primary-cta span { font-family:inherit; }

/* Table typography subtle soften */
table.txn-table td, table.txn-table th { font-family:inherit; }
table.txn-table td.desc { color:var(--text-base); }
table.txn-table td.num { color:var(--text-base); }

/* Slightly reduce vivid accent inside normal body copy */
a, .dev-link { color:var(--link-accent); }
a:hover, .dev-link:hover { color:var(--link-accent-hover); }
.app-shell { max-width: 1400px; margin: 0 auto; padding: 0 1.2rem 4rem; }

/* Header: clean, professional, integrated */
.dbz-header { 
  display:flex; 
  align-items:center; 
  justify-content:space-between;
  padding:1rem 0; 
  margin-bottom:1.5rem;
  border-bottom:1px solid rgba(255,255,255,0.06);
  background:var(--surface-0);
}
.dbz-header .logo-block { 
  display:flex; 
  align-items:center; 
  gap:.75rem;
}
.dbz-header .logo-content {
  display:flex;
  flex-direction:column;
  gap:.15rem;
}
.dbz-header .logo-line {
  display:flex;
  align-items:center;
  gap:.5rem;
}
.dbz-header .brand { 
  font-size:1.35rem; 
  font-weight:650; 
  background:linear-gradient(90deg,var(--accent) 0%,var(--accent-hover) 100%);
  -webkit-background-clip:text; 
  background-clip:text; 
  color:transparent; 
  letter-spacing:-.02em;
}
.dbz-header .version-chip { 
  background:rgba(255,179,71,0.08); 
  border:1px solid rgba(255,179,71,0.15); 
  padding:.15rem .4rem; 
  border-radius:4px; 
  font-size:.65rem; 
  font-weight:600; 
  letter-spacing:.04em; 
  text-transform:uppercase; 
  color:var(--accent); 
  opacity:.85;
}
.dbz-header .tagline { 
  font-size:.72rem; 
  color:var(--text-muted); 
  font-weight:500;
  opacity:.7;
  letter-spacing:.01em;
}
.dbz-header .header-actions { 
  display:flex; 
  align-items:center; 
  gap:.5rem; 
}

/* Mascot icon spacing and responsive sizing */
.mascot-icon {
  display: inline-block;
  vertical-align: middle;
  margin-right: 0.5rem;
  width: 44px;
  height: 44px;
  flex: 0 0 auto;
  transition: filter 0.3s;
}

.mascot-saiyan-glow {
  animation: mascotSaiyanGlow 1.1s cubic-bezier(.4,0,.2,1);
  filter:
    drop-shadow(0 0 16px #ffe66a)
    drop-shadow(0 0 32px #ffe66a)
    drop-shadow(0 0 48px #fff7b2);
}

@keyframes mascotSaiyanGlow {
  0% {
    filter: none;
  }
  10% {
    filter: drop-shadow(0 0 8px #ffe66a) drop-shadow(0 0 16px #ffe66a);
  }
  40% {
    filter: drop-shadow(0 0 16px #ffe66a) drop-shadow(0 0 32px #ffe66a) drop-shadow(0 0 48px #fff7b2);
  }
  80% {
    filter: drop-shadow(0 0 24px #ffe66a) drop-shadow(0 0 48px #ffe66a) drop-shadow(0 0 64px #fff7b2);
  }
  100% {
    filter: none;
  }
}

@media (max-width: 640px) {
  .mascot-icon {
    width: 32px;
    height: 32px;
    margin-right: 0.4rem;
  }
}

/* Mobile integration: search bar full-width; place date filters + categorize below it and keep symmetry */
@media (max-width: 640px) {
    .filters.consolidated {
      padding: .45rem .5rem .5rem .5rem;
    overflow-x:auto;
    scrollbar-width:auto;
    scrollbar-color:#36506a transparent;
  }

  .filters.consolidated .filters-head {
    flex-direction:column;
    align-items:stretch;
    gap:.5rem;
  }

  .filters.consolidated::-webkit-scrollbar {
    height:7px;
  }

  .filters.consolidated::-webkit-scrollbar-track {
    background:rgba(20,28,38,0.35);
    border-radius:999px;
  }

  .filters.consolidated::-webkit-scrollbar-thumb {
    background:linear-gradient(90deg, rgba(90,183,255,0.75), rgba(49,120,198,0.9));
    border-radius:999px;
  }

  .filters-toggle,
  .filters.consolidated .head-clear {
    width:100%;
    justify-content:center;
  }

  .filters-head .ai-status-pill {
    width:100%;
    justify-content:center;
  }

  /* Make the search composite occupy the full row */
  .filters .search-composite {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
    width: 100% !important;
    align-items: stretch !important;
  }

  .filters .search-composite input.filter-text {
    width: 100% !important;
    min-width: 0 !important;
    padding: .5rem .6rem !important;
    box-sizing: border-box !important;
  }

  /* Stack primary row grid (search left / date right) into a column and then place categorize below */
  .filter-primary-row.grid2 {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
    align-items: stretch !important;
    width: 100% !important;
  }

  /* Make date picker and categorize controls match heights/padding */
  .filter-primary-row.grid2 .primary-right,
  .filter-primary-row.grid2 .primary-left {
    width: 100% !important;
    display:flex !important;
    flex-direction:column !important;
    gap:8px !important;
  }

  .filters .date-range.compact {
    flex-direction:row;
    align-items:center;
    flex-wrap:wrap;
    gap:.3rem;
  }

  .filters .date-range.compact label {
    width:auto;
    flex-direction:row;
    align-items:center;
    gap:.25rem;
    font-size:.5rem;
    padding:.2rem .4rem;
    line-height:1;
  }

  .filters .date-range.compact .date-picker-display {
    height: 30px !important;
    padding: .2rem .4rem !important;
    font-size: .68rem !important;
    min-width: 0 !important;
    box-sizing: border-box !important;
  }

  .date-picker-display, .categorize-cluster .categorize-btn, .categorize-cluster .ai-pill-toggle.compact {
    height: 34px !important;
    padding: .32rem .5rem !important;
    min-width: 0 !important;
    box-sizing: border-box !important;
  }

  /* Place categorize cluster below the search + date area */
  .filter-primary-row.grid2 .primary-right .categorize-cluster {
    order: 100 !important;
    width: 100% !important;
    margin-top: 4px !important;
  }

  /* If categorize sits outside primary-right, ensure it's placed under search */
  .categorize-cluster { order: 200 !important; }

  /* Make categorize buttons slightly more compact to match date pickers */
  .categorize-cluster .categorize-btn.inline,
  .categorize-cluster .categorize-btn { padding: .36rem .55rem !important; font-size: .85rem !important; }

  /* Reduce chip sizes inside categorize to prevent overflow */
  .categorize-cluster .chip { padding: .22rem .4rem !important; font-size: .74rem !important; }
}

/* Stack and constrain categorize cluster on small screens */
@media (max-width: 640px) {
  .filters-advanced {
    padding:.35rem .45rem;
    overflow:hidden;
  }

  .filters-advanced-body .chip {
    padding:.2rem .35rem;
    font-size:.5rem;
  }

  .filters-advanced-body .col-toggle-btn {
    padding:.28rem .42rem .32rem;
    font-size:.48rem;
  }

  .filters-advanced-body .col-toggle-btn .indicator {
    width:7px;
    height:7px;
  }

  .filters-advanced-body .filters-secondary-row {
    flex-direction:column;
    align-items:stretch;
    gap:.6rem;
  }

  .filters-advanced-body .type-chips,
  .filters-advanced-body .source-chips,
  .filters-advanced-body .col-toggle-group {
    flex-wrap:wrap;
    overflow:visible;
    width:100%;
    max-width:100%;
  }

  .filters-advanced-body .filters-secondary-row > * {
    width:100%;
    max-width:100%;
  }

  .filters-advanced-body .source-chips {
    overflow-x:auto;
    scrollbar-width:auto;
    align-self:stretch;
  }

  .filters-secondary-row .col-toggle-group {
    flex-wrap:wrap;
    overflow-x:auto;
    scrollbar-width:auto;
  }

  .filters-advanced-body .source-chips::-webkit-scrollbar,
  .filters-secondary-row .col-toggle-group::-webkit-scrollbar {
    height:6px;
  }

  .filters-advanced-body .source-chips::-webkit-scrollbar-track,
  .filters-secondary-row .col-toggle-group::-webkit-scrollbar-track {
    background:transparent;
  }

  .filters-advanced-body .source-chips::-webkit-scrollbar-thumb,
  .filters-secondary-row .col-toggle-group::-webkit-scrollbar-thumb {
    background:#25303c;
    border-radius:20px;
  }

  .filters-advanced-body .source-chips .chip,
  .filters-advanced-body .type-chips .chip,
  .filters-advanced-body .col-toggle-group .col-toggle-btn {
    max-width:100%;
    white-space:normal;
  }

  .categorize-cluster {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
    align-items: stretch !important;
    width: 100% !important;
    padding: 10px !important;
    box-sizing: border-box !important;
  }

  .categorize-cluster .cat-main-row,
  .categorize-cluster .cat-left-group,
  .categorize-cluster .cat-right-group {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
    align-items: stretch !important;
    width: 100% !important;
  }

  .categorize-cluster .categorize-btn,
  .categorize-cluster .categorize-btn.inline,
  .categorize-cluster .ai-pill-toggle.compact,
  .categorize-cluster .cat-status-badge,
  .categorize-cluster .cat-foot-row {
    width: 100% !important;
    min-width: 0 !important;
    box-sizing: border-box !important;
  }

  /* Make tag/legend chips wrap instead of overflowing */
  .categorize-cluster .cat-left-group .chip,
  .categorize-cluster .cat-right-group .chip,
  .categorize-cluster .acct-mini-counts {
    flex: 0 1 auto !important;
    min-width: 0 !important;
    max-width: 100% !important;
    white-space: normal !important;
    overflow-wrap: anywhere !important;
  }

  /* If there are inline actions on the right, move them under the main content */
  .categorize-cluster .cat-right-group { order: 99 !important; }

  /* Reduce font-size slightly to help fit tight groups */
  .categorize-cluster, .categorize-cluster * { font-size: 0.95em !important; }
}

/* Strong exceptions for the accounts ratio (mix-bar) on very small screens.
   These rules override broader "make every child 100% width" fallbacks so the
   small ratio bar renders horizontally and keeps its colors and proportions. */
@media (max-width: 640px) {
  .metric.accounts-metric .acct-legend .mix-bar {
    display: flex !important;
    flex-direction: row !important;
    flex-wrap: nowrap !important;
    gap: 0 !important;
    align-items: center !important;
    justify-content: flex-start !important;
    height: 8px !important;
    min-width: 40px !important;
    width: calc(100% - 0px) !important;
    overflow: hidden !important;
    background: #202a34 !important;
  }

  .metric.accounts-metric .acct-legend .mix-bar .seg {
    /* Allow inline/percentage widths from JS/markup to control segment size.
       If no inline width is present, let segments grow proportionally. */
    flex: 0 0 auto !important;
    min-width: 8px !important;
    height: 100% !important;
    display: block !important;
    opacity: 1 !important;
    filter: none !important;
    background-blend-mode: normal !important;
    border-radius: 0 !important;
    box-sizing: border-box !important;
  }

  .metric.accounts-metric .acct-legend .mix-bar .seg:first-child {
    border-top-left-radius: 4px !important;
    border-bottom-left-radius: 4px !important;
  }

  .metric.accounts-metric .acct-legend .mix-bar .seg:last-child {
    border-top-right-radius: 4px !important;
    border-bottom-right-radius: 4px !important;
  }

  /* If widths are applied inline (style attribute), keep them honored */
  .metric.accounts-metric .acct-legend .mix-bar .seg[style] {
    flex: 0 0 auto !important;
  }

  /* If a segment does not have an inline width provided by JS, allow it
     to flex and proportionally share the remaining space. */
  .metric.accounts-metric .acct-legend .mix-bar .seg:not([style]) {
    flex: 1 1 0 !important;
    width: auto !important;
  }

  /* Prevent the generic rule that makes children 100% from affecting mixes */
  .metric.accounts-metric .acct-legend, .metric.accounts-metric .acct-legend * {
    min-width: 0 !important;
    max-width: 100% !important;
  }

  /* Ensure the legend chips don't wrap over the mix-bar */
  .metric.accounts-metric .acct-legend .acct-mini-counts {
    display:flex !important;
    flex-wrap:wrap !important;
    gap:6px !important;
    margin-top:6px !important;
  }
}

@media (prefers-reduced-motion: reduce) {
  .mascot-icon { transition: none !important; }
}

.upload-panel { display:flex; align-items:center; gap:1rem; flex-wrap:wrap; margin:var(--section-gap) 0; }

/* Site footer with domain and trust tagline */
.site-footer {
  margin-top:2.6rem;
  padding-top:1.1rem;
  border-top:1px solid rgba(255,255,255,0.03);
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:1rem;
  color:var(--text-muted);
  font-size:0.84rem;
}
.site-footer .brand { font-weight:700; color:var(--text-base); }
.site-footer .footer-inner {
  width:100%;
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:1.4rem;
  flex-wrap:wrap;
}
.site-footer .footer-left,
.site-footer .footer-right {
  display:flex;
  gap:.45rem;
}
.site-footer .footer-left {
  flex-direction:column;
  align-items:flex-start;
  gap:.3rem;
}
.site-footer .footer-right {
  flex-wrap:wrap;
  align-items:center;
  justify-content:flex-end;
  gap:.5rem 1rem;
}
.site-footer .footer-brandline,
.site-footer .footer-legal,
.site-footer .footer-links {
  display:flex;
  align-items:center;
  gap:.45rem;
  flex-wrap:wrap;
}
.site-footer .brand-note,
.site-footer .legal-note,
.site-footer .copyright {
  color:var(--text-muted);
}
.site-footer .footer-trust small { color:var(--text-muted); }
.site-footer .sep { opacity:.45; }
.site-footer .footer-link { color:var(--text-base); text-decoration:none; font-weight:600; }
.site-footer .footer-link:hover { text-decoration:underline; }
.site-footer .contact-trigger {
  display:inline-flex;
  align-items:center;
  gap:.35rem;
  padding:.35rem .6rem;
  border-radius:999px;
  border:1px solid var(--surface-2-border);
  background:var(--surface-2);
  color:var(--text-base);
  font-size:.72rem;
  letter-spacing:.05em;
  text-transform:uppercase;
  cursor:pointer;
}
.site-footer .contact-trigger .caret { opacity:.7; font-size:.7rem; }
.site-footer .contact-trigger:hover { background:var(--surface-3); }
.site-footer .contact-wrap { position:relative; }
.site-footer .contact-popover {
  position:absolute;
  bottom:120%;
  right:0;
  width:min(320px, 80vw);
  box-sizing:border-box;
  background:var(--surface-2);
  border:1px solid var(--surface-2-border);
  border-radius:12px;
  box-shadow:0 12px 24px -14px rgba(0,0,0,.7);
  padding:.7rem .75rem;
  display:none;
  flex-direction:column;
  gap:.6rem;
  z-index:10;
}
.site-footer .contact-popover.open { display:flex; }
.site-footer .contact-popover-head { display:flex; flex-direction:column; gap:.25rem; font-size:.72rem; color:var(--text-muted); }
.site-footer .contact-fields { display:flex; flex-direction:column; gap:.4rem; }
.site-footer .contact-input,
.site-footer .contact-textarea {
  width:100%;
  box-sizing:border-box;
  background:#121820;
  border:1px solid #202b36;
  color:var(--text-strong);
  border-radius:8px;
  padding:.45rem .55rem;
  font-size:.78rem;
  outline:none;
}
.site-footer .contact-textarea { resize:vertical; min-height:64px; }
.site-footer .contact-input:focus,
.site-footer .contact-textarea:focus { border-color:var(--accent); box-shadow:0 0 0 2px rgba(255,179,71,0.25); }
.site-footer .contact-actions { display:flex; gap:.5rem; justify-content:flex-end; }
.site-footer .btn.ghost { background:transparent; border:1px solid rgba(255,255,255,0.1); }
.upload-btn { position:relative; display:inline-flex; align-items:center; gap:.55rem; background:linear-gradient(135deg,var(--surface-2) 0%,var(--surface-3) 70%); padding:.75rem 1.05rem; border-radius:10px; cursor:pointer; font-weight:600; font-size:.82rem; letter-spacing:.05em; text-transform:uppercase; color:var(--text-strong); border:1px solid var(--surface-2-border); box-shadow:0 4px 10px -4px rgba(0,0,0,.55), 0 0 0 1px rgba(255,255,255,.04) inset; transition:background .25s, box-shadow .25s, transform .2s, border-color .25s; }
.upload-btn { overflow:hidden; }
.upload-btn:after { content:""; position:absolute; inset:0; border-radius:inherit; background:radial-gradient(circle at 35% 50%, rgba(255,179,71,.55), rgba(255,179,71,0) 65%); opacity:0; transform:scale(.65); pointer-events:none; mix-blend-mode:screen; }
.upload-btn:hover:after { animation:uploadPulse 1.9s ease-in-out infinite; }
@keyframes uploadPulse { 0% { opacity:0; transform:scale(.55); } 15% { opacity:.55; } 40% { opacity:.25; transform:scale(1.05); } 70% { opacity:.08; transform:scale(1.55); } 100% { opacity:0; transform:scale(1.75); } }
@media (prefers-reduced-motion: reduce) { .upload-btn:hover:after { animation:none; } }
.upload-panel.drop-active, .cover.drop-active { outline:2px dashed var(--accent); outline-offset:4px; background:#151d25; }
.upload-btn:before { content:""; position:absolute; inset:0; border-radius:inherit; padding:1px; background:linear-gradient(120deg,rgba(255,179,71,.7),rgba(255,179,71,0) 45%, rgba(90,214,125,.55)); -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); -webkit-mask-composite: xor; mask-composite: exclude; opacity:.55; pointer-events:none; transition:opacity .35s; }
.upload-btn:hover { background:linear-gradient(135deg,#1f2a35 0%,#273544 70%); box-shadow:0 6px 16px -6px rgba(0,0,0,.7), 0 1px 0 rgba(255,255,255,.05) inset; }
.upload-btn:active { transform:translateY(1px); background:linear-gradient(135deg,#1a242d 0%,#22303d 70%); }
.upload-btn:focus-visible { outline:none; box-shadow:0 0 0 2px #0f1115, 0 0 0 4px var(--accent); }
.upload-btn input { position:absolute; inset:0; opacity:0; cursor:pointer; }
.upload-btn svg { width:16px; height:16px; stroke:var(--accent); }
.reset-btn { background:var(--surface-2); border:1px solid var(--surface-2-border); color:var(--text-strong); padding:.65rem .9rem; border-radius:8px; font-size:.75rem; letter-spacing:.05em; cursor:pointer; text-transform:uppercase; font-weight:600; box-shadow:0 1px 3px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.03) inset; transition:background-color 200ms ease, transform 150ms ease, box-shadow 200ms ease; }
.reset-btn:hover { background:var(--surface-3); transform:translateY(-1px); box-shadow:0 4px 10px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,255,255,0.05) inset; }
.download-actions { display:flex; gap:.55rem; margin:.9rem 0 .35rem; flex-wrap:wrap; }
.download-btn { position:relative; display:inline-flex; align-items:center; gap:.45rem; background:linear-gradient(135deg,var(--surface-2) 0%,var(--surface-3) 70%); padding:.58rem .9rem .6rem; border-radius:9px; cursor:pointer; font-weight:600; font-size:.68rem; letter-spacing:.06em; text-transform:uppercase; color:#f5f7fa; border:1px solid var(--surface-2-border); box-shadow:0 1px 3px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,.04) inset; transition:background 200ms ease, box-shadow 200ms ease, transform 150ms ease, border-color 200ms ease; }
.download-btn:hover { background:linear-gradient(135deg,var(--surface-3) 0%,#273544 70%); box-shadow:0 4px 12px rgba(0,0,0,.5), 0 0 0 1px rgba(255,255,255,.05) inset; transform:translateY(-1px); }
.download-btn:active { transform:translateY(1px); background:linear-gradient(135deg,#1a242d 0%,#22303d 70%); }
/* Unified button tokens - small, medium, icon, and link styles */
.btn {
  display:inline-flex; align-items:center; justify-content:center; gap:.45rem;
  padding:.48rem .72rem; border-radius:8px; font-weight:600; font-size:.85rem; color:var(--text-strong);
  background:var(--surface-2); border:1px solid var(--surface-2-border); box-shadow:0 1px 3px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.03) inset;
  transition:transform 150ms ease, box-shadow 200ms ease, background-color 200ms ease, border-color 200ms ease;
}
.btn:hover {
  background:var(--surface-3);
  border-color:var(--surface-3-border);
  box-shadow:0 4px 10px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,255,255,0.05) inset;
  transform:translateY(-1px);
}
.btn:active { transform:translateY(1px); }
.btn:focus-visible { outline:none; box-shadow: var(--focus-ring); }
.btn.small { padding:.34rem .5rem; font-size:.78rem; border-radius:6px; }

/* Bigger hit area and improved spacing for the metric title: left align */
.metric > span { text-align:left; }

.download-btn:focus-visible { outline:none; box-shadow:0 0 0 2px #0f1115, 0 0 0 4px var(--accent); }

/* Mini undo button used inline in transaction rows */
.undo-mini {
  display:inline-flex;
  align-items:center;
  justify-content:center;
  height:22px;
  min-width:22px;
  padding:0 6px;
  border-radius:6px;
  background:transparent;
  color:var(--text-base);
  border:1px solid rgba(255,255,255,0.04);
  font-size:0.78rem;
  cursor:pointer;
  transition:background .12s, color .12s, box-shadow .12s, transform .08s;
}
.undo-mini:hover { background:linear-gradient(180deg, rgba(255,179,71,0.06), rgba(255,179,71,0.03)); color:var(--accent); }
.undo-mini:active { transform:translateY(1px); }
.undo-mini:focus-visible { outline:none; box-shadow:0 0 0 2px #0f1115, 0 0 0 4px var(--accent); }

/* Tooltip hint (uses title attribute; for a styled arrow we use a pseudo-element when .has-tooltip class is set) */
.undo-mini.has-tooltip { position:relative; }
.undo-mini.has-tooltip:after {
  content: attr(data-tooltip);
  position:absolute;
  bottom: calc(100% + 8px);
  left:50%;
  transform:translateX(-50%);
  white-space:nowrap;
  background:var(--panel-bg);
  color:var(--text-base);
  padding:6px 8px;
  border-radius:6px;
  font-size:0.72rem;
  border:1px solid var(--panel-border);
  box-shadow:0 6px 18px rgba(0,0,0,.6);
  opacity:0; pointer-events:none; transition:opacity .12s ease;
}
.undo-mini.has-tooltip:hover:after, .undo-mini.has-tooltip:focus-visible:after { opacity:1; }


.spinner { width:28px; height:28px; border:4px solid var(--surface-2); border-top-color:var(--accent); border-radius:50%; animation:spin 1s linear infinite; }
@keyframes spin { to { transform:rotate(360deg);} }
.error { color:#ff6b6b; font-weight:600; background:rgba(255,107,107,0.1); padding:.35rem .6rem; border-radius:6px; border:1px solid rgba(255,107,107,0.3); }

.metrics { display:grid; grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); gap:var(--card-gap); margin:0 0 var(--section-gap); }
.metric { background:linear-gradient(160deg, rgba(25,33,43,0.92) 0%, rgba(12,16,22,0.95) 100%); padding:.7rem .85rem; border:1px solid rgba(255,255,255,0.08); border-radius:var(--panel-radius); display:flex; flex-direction:column; gap:.3rem; box-shadow:0 6px 12px -8px rgba(0,0,0,.7), 0 1px 0 rgba(255,255,255,.02) inset; position:relative; transition:transform 150ms ease, box-shadow 200ms ease, background-color 200ms ease, border-color 200ms ease; }
.metric:hover { transform:translateY(-1px); border-color:rgba(255,255,255,0.16); box-shadow:0 10px 18px -12px rgba(0,0,0,.75), 0 1px 0 rgba(255,255,255,.04) inset; }
.metric > span, .metric .metric-head > span { font-size:.72rem; letter-spacing:.08em; text-transform:uppercase; color:var(--text-muted); font-weight:700; }
.metric strong { font-size:1.15rem; font-weight:650; color:var(--text-strong); }
.metric.composite strong { font-size:.85rem; letter-spacing:.04em; }
.metric-head { display:flex; align-items:center; justify-content:space-between; gap:.5rem; }
.metric.composite .substats { display:grid; gap:.25rem; margin-top:.1rem; }
.metric.composite .substats .row { display:flex; justify-content:space-between; font-size:.6rem; letter-spacing:.03em; }
.metric.composite .substats .row .lbl { opacity:.6; text-transform:uppercase; }
.metric.composite .substats .row .val { font-variant-numeric:tabular-nums; }
.metric.composite .substats .row { border-bottom:1px solid rgba(255,255,255,.06); padding-bottom:.15rem; }
.metric.composite .substats .row:last-child { border-bottom:0; padding-bottom:0; }
.metric.composite.status-good { border-color:rgba(90,214,125,.35); }
.metric.composite.status-warn { border-color:rgba(255,179,71,.35); }
.metric.composite.status-attn { border-color:rgba(255,107,107,.35); }
/* Subtle left accent for composite metrics */
.metric.composite:before { content:""; position:absolute; left:0; top:0; bottom:0; width:3px; border-radius:var(--radius-lg) 0 0 var(--radius-lg); background:linear-gradient(180deg, var(--accent), rgba(255,179,71,0)); opacity:.4; }
/* Status-based accent overrides */
.metric.composite.status-good:before { background:linear-gradient(180deg, #5ad67d, rgba(90,214,125,0)); opacity:.6; }
.metric.composite.status-warn:before { background:linear-gradient(180deg, #ffb347, rgba(255,179,71,0)); opacity:.6; }
.metric.composite.status-attn:before { background:linear-gradient(180deg, #ff6b6b, rgba(255,107,107,0)); opacity:.6; }
/* Accounts bubble refinements */
.metric.accounts-metric { display:flex; flex-direction:column; }
.metric.accounts-metric .possible-issues-cta { align-self:flex-start; }
.metric.accounts-metric .txns-line { display:flex; align-items:center; gap:.4rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.metric.accounts-metric .txns-line .badge-inline { margin-left:.3rem; }
.metric.accounts-metric .txns-line .label { font-size:.6rem; letter-spacing:.07em; text-transform:uppercase; opacity:.75; font-weight:600; }
.metric.accounts-metric .acct-legend { grid-area:chips; display:flex; flex-direction:column; gap:.3rem; }
.metric.accounts-metric .acct-legend .mix-bar { display:flex; height:6px; background:#202a34; border:1px solid #2d3946; border-radius:4px; overflow:hidden; }
.metric.accounts-metric .acct-legend .mix-bar .seg { display:inline-block; height:100%; background:linear-gradient(90deg, #2e3a48, #2e3a48); }
.metric.accounts-metric .acct-legend .mix-bar .seg.checking { background: linear-gradient(90deg, var(--acct-checking), color-mix(in srgb, var(--acct-checking) 60%, #0f1115 40%)); }
.metric.accounts-metric .acct-legend .mix-bar .seg.savings { background: linear-gradient(90deg, var(--acct-savings), color-mix(in srgb, var(--acct-savings) 60%, #0f1115 40%)); }
.metric.accounts-metric .acct-legend .mix-bar .seg.credit-card { background: linear-gradient(90deg, var(--acct-credit), color-mix(in srgb, var(--acct-credit) 60%, #0f1115 40%)); }
.metric.accounts-metric .acct-mini-counts { margin-top:0; gap:.25rem .35rem; }
.metric .badge-inline.possible { background:rgba(255,179,71,0.1); color:#ffb347; border-color:rgba(255,179,71,0.25); }
.metric.status-warn .badge-inline.possible { background:rgba(255,179,71,0.15); color:#ffb347; border-color:rgba(255,179,71,0.3); }
.metric.status-attn .badge-inline.possible { background:rgba(255,107,107,0.1); color:#ff6b6b; border-color:rgba(255,107,107,0.25); }
.metric.status-good .badge-inline.possible { background:rgba(90,214,125,0.1); color:#5ad67d; border-color:rgba(90,214,125,0.25); }
.metric .badge-inline.possible:hover { filter:brightness(1.06); box-shadow:0 0 0 2px rgba(255,179,71,.12) inset; }
.metric .badge-inline.possible.open { filter:brightness(1.03); }
.metric .badge-inline { display:inline-block; padding:.12rem .45rem .18rem; border-radius:6px; font-size:.55rem; font-weight:700; letter-spacing:.06em; background:var(--surface-2); border:1px solid var(--surface-2-border); margin-left:.4rem; transition:filter 150ms ease, box-shadow 150ms ease, transform 150ms ease; }
.metric .badge-inline:hover { transform:translateY(-1px); filter:brightness(1.1); }
.metric .badge-inline.good { background:rgba(90,214,125,0.15); color:#5ad67d; border-color:rgba(90,214,125,0.3); box-shadow:0 0 0 1px rgba(90,214,125,0.1) inset; }
.metric .badge-inline.warn { background:rgba(255,179,71,0.15); color:#ffb347; border-color:rgba(255,179,71,0.3); box-shadow:0 0 0 1px rgba(255,179,71,0.1) inset; }
.metric .badge-inline.attn { background:rgba(255,107,107,0.15); color:#ff6b6b; border-color:rgba(255,107,107,0.3); box-shadow:0 0 0 1px rgba(255,107,107,0.1) inset; }
.metric .badge-inline.pop-btn { cursor:pointer; position:relative; padding-right:.9rem; }
.metric .badge-inline.pop-btn:after { content:"▾"; position:absolute; right:.35rem; top:50%; transform:translateY(-52%); font-size:.6rem; opacity:.85; }
.metric .badge-inline.pop-btn.open:after { content:"▴"; }
.metric .badge-inline.pop-btn:hover { filter:brightness(1.05); box-shadow:0 0 0 2px rgba(77,183,255,.08) inset; }
.metric .badge-inline.pop-btn:focus { outline:2px solid #4db7ff; outline-offset:2px; }
.metric .micro { font-size:.55rem; letter-spacing:.07em; text-transform:uppercase; opacity:.6; font-weight:600; }
.metric.dual-line strong { font-size:.9rem; }
.metric.dual-line .secondary { font-size:.58rem; letter-spacing:.05em; opacity:.75; font-weight:600; margin-top:-.15rem; }
.metric .secondary { font-size:.58rem; letter-spacing:.04em; opacity:.75; font-weight:600; margin-top:.05rem; }
.allocation-bars { display:grid; gap:3px; margin-top:.2rem; }
.allocation-bars .bar-row { display:flex; align-items:center; gap:.4rem; font-size:.54rem; letter-spacing:.05em; }
.allocation-bars .bar-row .name { flex:0 0 52px; text-transform:uppercase; opacity:.68; font-weight:700; color:var(--text-muted); }
.allocation-bars .bar-row .track { position:relative; flex:1; height:6px; background:#202a34; border:1px solid #2d3946; border-radius:4px; overflow:hidden; }
.allocation-bars .bar-row .fill { position:absolute; inset:0; width:0; background:linear-gradient(90deg,#4db7ff,#5ad67d); }
.allocation-bars .bar-row.income .fill { background: linear-gradient(90deg, var(--alloc-income-start), var(--alloc-income-end)); }
.allocation-bars .bar-row.savings .fill { background: linear-gradient(90deg, var(--alloc-savings-start), var(--alloc-savings-end)); }
.allocation-bars .bar-row.expense .fill { background: linear-gradient(90deg, var(--alloc-expense-start), var(--alloc-expense-end)); }
.allocation-bars .bar-row.unallocated .fill { background: linear-gradient(90deg, var(--alloc-unallocated-start), var(--alloc-unallocated-end)); }
.allocation-bars .bar-row .pct { flex:0 0 40px; text-align:right; font-variant-numeric:tabular-nums; }
.allocation-bars.compact .bar-row .name { flex:0 0 52px; }
.acct-mini-counts { display:flex; flex-wrap:wrap; gap:.25rem .35rem; margin-top:.25rem; }
.acct-chip { background:var(--surface-2); border:1px solid var(--surface-2-border); padding:.18rem .45rem .22rem; border-radius:14px; font-size:.52rem; font-weight:600; letter-spacing:.06em; text-transform:uppercase; color:#d4d9df; white-space:nowrap; transition:transform 150ms ease, box-shadow 150ms ease; }
.acct-chip:hover { transform:translateY(-1px); box-shadow:0 2px 6px rgba(0,0,0,0.4); }
/* Align chip colors with chart palette (driven by tokens) */
.acct-chip.checking { background: color-mix(in srgb, var(--acct-checking) 10%, #0f1115 90%); border-color: color-mix(in srgb, var(--acct-checking) 20%, #0f1115 80%); color: var(--acct-checking); }
.acct-chip.savings { background: color-mix(in srgb, var(--acct-savings) 10%, #0f1115 90%); border-color: color-mix(in srgb, var(--acct-savings) 20%, #0f1115 80%); color: var(--acct-savings); }
.acct-chip.credit-card { background: color-mix(in srgb, var(--acct-credit) 12%, #0f1115 88%); border-color: color-mix(in srgb, var(--acct-credit) 22%, #0f1115 78%); color: var(--acct-credit); }
.consistency-badge-wrap { position:relative; display:inline-block; margin-left:.4rem; /* allow popovers to escape clipping */ overflow: visible; }
.consistency-popover { position:absolute; top:125%; right:0; width:260px; background:#12181f; border:1px solid #2d3946; border-radius:10px; padding:.65rem .7rem .75rem; box-shadow:0 6px 18px -4px rgba(0,0,0,.55),0 2px 4px rgba(0,0,0,.5); z-index: 99999; pointer-events: auto; }
.consistency-popover:before { content:""; position:absolute; top:-6px; right:18px; width:10px; height:10px; background:#12181f; border-left:1px solid #2d3946; border-top:1px solid #2d3946; transform:rotate(45deg); }
.consistency-popover .cp-head { font-size:.6rem; letter-spacing:.08em; text-transform:uppercase; opacity:.8; margin-bottom:.45rem; font-weight:700; color:#ffb347; }
.consistency-popover .cp-head .micro { margin-left:.35rem; opacity:.75; }
.consistency-popover .cp-head .cp-subcount { margin-left:.35rem; font-size:.58rem; letter-spacing:.04em; opacity:.7; text-transform:none; font-weight:600; }
.metric.status-good .consistency-popover .cp-head { color:#5ad67d; }
.metric.status-warn .consistency-popover .cp-head { color:#ffb347; }
.metric.status-attn .consistency-popover .cp-head { color:#ff6b6b; }
.consistency-popover .cp-empty { font-size:.58rem; opacity:.7; }
.consistency-popover .cp-list { list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:.35rem; max-height:160px; overflow:auto; }
.consistency-popover .cp-item { display:flex; align-items:flex-start; gap:.35rem; font-size:.6rem; line-height:1.15; letter-spacing:.03em; }
.consistency-popover .cp-item .lvl-icon { font-size:.65rem; line-height:1; margin-top:2px; }
.consistency-popover .cp-item.lvl-info .lvl-icon { color:#4db7ff; }
.consistency-popover .cp-close { position:absolute; top:4px; right:6px; background:none; border:0; color:#9fa6b2; font-size:.9rem; cursor:pointer; line-height:1; padding:.15rem; }
.consistency-popover .cp-close:hover { color:#e6e9ee; }

.filters { display:flex; flex-direction:column; gap:.4rem; margin:0 0 1rem; }
.filters.consolidated { background:#151c24; border:1px solid #24313d; padding:calc(var(--container-pad-y) - .2rem) calc(var(--container-pad-x) - .25rem); border-radius:var(--panel-radius); box-shadow:0 4px 14px -6px rgba(0,0,0,.55); position:relative; }
.filters.consolidated.advanced-only { margin-bottom:.6rem; }
.filters.consolidated.table-filters { padding-bottom:.25rem; }
.filters.consolidated .filters-head { display:flex; align-items:center; justify-content:space-between; margin-bottom:.15rem; }
.filters.consolidated .filters-title { display:flex; flex-direction:column; gap:.15rem; }
.filters.consolidated .filters-label { font-size:.6rem; letter-spacing:.08em; text-transform:uppercase; font-weight:700; color:#9fb1bd; }
.filters.consolidated .filters-meta { font-size:.58rem; color:#7f8f9c; }
.filters.consolidated .filters-head-actions { display:flex; align-items:center; gap:.45rem; }
.filters-toggle { background:#19222c; border:1px solid #2c3845; color:#d5dae0; padding:.45rem .75rem .5rem; border-radius:9px; font-size:.6rem; letter-spacing:.07em; font-weight:600; text-transform:uppercase; cursor:pointer; position:relative; overflow:hidden; transition:background .3s, color .3s, border-color .3s; }
.filters-toggle:after { content:""; position:absolute; inset:0; background:radial-gradient(circle at 30% 50%,rgba(255,179,71,.4),rgba(255,179,71,0) 70%); opacity:0; transform:scale(.6); transition:opacity .5s, transform .6s; mix-blend-mode:overlay; pointer-events:none; }
.filters-toggle:hover { background:#1f2a35; }
.filters-toggle:hover:after { opacity:.55; transform:scale(1.4); }
.filters.consolidated .head-clear { margin-left:.5rem; }
.filters-summary { display:flex; align-items:center; flex-wrap:wrap; gap:.35rem; margin:.1rem 0 .25rem; }
.filters-summary-label { font-size:.55rem; letter-spacing:.06em; text-transform:uppercase; font-weight:600; color:#9fb1bd; }
.filters-summary-chip { background:#1b242d; border:1px solid #283340; color:#d4d9df; padding:.18rem .45rem; border-radius:999px; font-size:.52rem; letter-spacing:.04em; text-transform:uppercase; }
.filters-panel { display:flex; flex-direction:column; gap:.25rem; animation:slideFadeInFilter .35s cubic-bezier(.4,0,.2,1); }
.filters-actions-row { display:flex; align-items:center; justify-content:flex-start; gap:.5rem; flex-wrap:wrap; margin-top:.2rem; }
@keyframes slideFadeInFilter {
  /* Avoid using `transform` here to prevent creating a new stacking context on the filters container.
     Use opacity + margin changes (reflow) instead so popovers mounted outside can appear above filters. */
  0% { opacity: 0; margin-top: -6px; }
  60% { opacity: 1; margin-top: 2px; }
  100% { opacity: 1; margin-top: 0; }
}
.filter-primary-row { display:grid; grid-template-columns:1fr auto auto auto; gap:.3rem; align-items:stretch; }
.filter-primary-row.grid2 { grid-template-columns: 1fr minmax(280px, 1fr); gap:.3rem; }
.filter-primary-row.grid2 .primary-left { display:flex; flex-direction:column; gap:.55rem; }
.filter-primary-row.grid2 .primary-right { display:flex; flex-direction:column; gap:.4rem; }
@media (max-width:900px){ .filter-primary-row { grid-template-columns:1fr; } .filters-secondary-row { flex-direction:column; align-items:stretch; } }
.filters-secondary-row { display:flex; flex-direction:row; gap:.4rem; align-items:flex-start; }
.filters-secondary-row > * { align-self:stretch; }
.filters-secondary-row .type-chips { flex:1; }
.filters-secondary-row .col-toggle-group { display:flex; flex-wrap:nowrap; margin-left:auto; justify-content:flex-end; max-width:100%; overflow-x:auto; -webkit-overflow-scrolling:touch; gap:.45rem; padding-bottom:.15rem; }
@supports (scrollbar-width: none){ .filters-secondary-row .col-toggle-group { scrollbar-width:none; } }
.filters-secondary-row .col-toggle-group::-webkit-scrollbar { height:6px; }
.filters-secondary-row .col-toggle-group::-webkit-scrollbar-track { background:transparent; }
.filters-secondary-row .col-toggle-group::-webkit-scrollbar-thumb { background:#25303c; border-radius:20px; }
@media (max-width:900px){ .filters-secondary-row .col-toggle-group { margin-left:0; justify-content:flex-start; } }
.filters-advanced { background:transparent; border:0; border-radius:0; padding:0; box-shadow:none; margin-bottom:.7rem; }
.filters-advanced-body { padding-top:.1rem; }
.filters-advanced-body .filters-secondary-row { display:flex; flex-wrap:nowrap; gap:.5rem; align-items:center; }
.filters-advanced-body .type-chips,
.filters-advanced-body .source-chips,
.filters-advanced-body .col-toggle-group { display:flex; flex-wrap:nowrap; gap:.35rem; }
.filters-advanced-body .type-chips { flex:0 0 auto; }
.filters-advanced-body .source-chips { flex:1 1 auto; overflow-x:auto; -webkit-overflow-scrolling:touch; }
.filters-advanced-body .col-toggle-group { flex:0 0 auto; }
.filters-advanced-body .chip { padding:.25rem .45rem; border-radius:14px; font-size:.52rem; min-height:auto; }
.filters-advanced-body .chip.active { filter:saturate(1.1); }
.filters-advanced-body .col-toggle-btn { padding:.32rem .5rem .36rem; font-size:.5rem; }
.filters-advanced-body .col-toggle-btn .indicator { width:8px; height:8px; }
.col-toggle-group.compact { gap:.35rem .5rem; }
.filters .date-range.compact { flex-direction:row; gap:.45rem; margin-top:0; }
.filters .date-range.compact label { font-size:.55rem; }
.filters.consolidated .filter-text { align-self:stretch; display:flex; }
.filters.consolidated input.filter-text { height:38px; }
.filters .search-composite { position:relative; display:flex; align-items:center; }
.filters .search-composite input.filter-text { width:100%; padding-right:9.6rem; } /* leave room for date pills */
.filters .search-composite .date-range.inside-search { position:absolute; right:.4rem; top:50%; transform:translateY(-50%); display:flex; align-items:center; gap:.28rem; margin-top:0; }
.filters .search-composite .date-range.inside-search label { flex-direction:row; align-items:center; gap:.24rem; background:#161e26; border:1px solid #273545; padding:.14rem .26rem; border-radius:.38rem; font-size:.46rem; color:#9fb1bd; }
.filters .search-composite .date-range.inside-search .lbl { text-transform:uppercase; letter-spacing:.05em; opacity:.72; }
.filters .search-composite .date-range.inside-search .date-picker-display { padding:.22rem .34rem .2rem; font-size:.62rem; min-width:unset; border-radius:6px; }
.filters .search-composite .date-range.inside-search .date-picker { min-width:96px; }
.filters .search-composite:focus-within input.filter-text { outline:2px solid #3a516a; }
.filters .search-composite:focus-within .date-range.inside-search label { border-color:#314a61; box-shadow:0 0 0 1px rgba(49,74,97,.25); }
@media (max-width: 720px){
  .filters .search-composite { flex-direction:column; align-items:stretch; gap:.4rem; }
  .filters .search-composite input.filter-text { padding-right:.7rem; }
  .filters .search-composite .date-range.inside-search { position:static; transform:none; justify-content:flex-start; flex-wrap:wrap; gap:.3rem; }
}
.filter-primary-row > * { display:flex; flex-direction:column; justify-content:stretch; }
@media (prefers-reduced-motion: reduce){ .filters-panel { animation:none; } .filters-toggle:after { display:none; } }
.filters input { background:#14191f; border:1px solid #2a3848; padding:.55rem .7rem; border-radius:8px; color:var(--text-strong); font-size:.9rem; }
.filters input:focus { outline:2px solid #3a516a; }
.filters .date-range { display:flex; align-items:flex-end; gap:.5rem; margin-top:-9px; /* fine-tuned lift for bottom border alignment */ }
.filters .date-range label { display:flex; flex-direction:column; gap:1px; font-size:.55rem; letter-spacing:.08em; text-transform:uppercase; font-weight:600; color:#8ca0b3; line-height:1; }
.filters .date-range label .lbl { opacity:.75; }
.filters .date-range input[type=date] { padding:.55rem .6rem .5rem; font-size:.75rem; letter-spacing:.03em; }

.table-controls { display:grid; grid-template-columns: 1fr auto 1fr; align-items:center; column-gap:.5rem; margin:0 0 .8rem; width:100%; }
.table-controls .table-search { min-width:0; display:flex; align-items:center; justify-content:flex-start; gap:.35rem; flex-wrap:nowrap; justify-self:start; }
.table-controls .table-categorize { justify-self:center; align-items:flex-start; }
.table-controls .table-columns { justify-self:end; }
.table-controls .table-search-input { width:clamp(150px, 18vw, 220px); height:20px; min-width:0; padding:.15rem .35rem; font-size:.7rem; }
.table-controls .table-date-range { display:flex; align-items:center; gap:.35rem; margin-top:0; }
.table-controls .table-date-range label { display:flex; align-items:center; gap:.3rem; background:#151c24; border:1px solid #24313d; padding:.16rem .25rem; border-radius:6px; font-size:.48rem; letter-spacing:.06em; text-transform:uppercase; color:#9fb1bd; overflow:hidden; height:auto; }
.table-controls .table-date-range .lbl { opacity:.7; }
.table-controls .table-date-range .date-picker { display:flex; align-items:center; align-self:center; position:relative; top:-8px; }
.table-controls .table-date-range .date-picker-display { display:inline-flex; align-items:center; height:auto; min-width:0; padding:0; font-size:.6rem; line-height:1.1; border-radius:0; background:transparent; background-color:transparent; border:0; box-shadow:none; color:inherit; appearance:none; -webkit-appearance:none; }
.table-controls .table-date-range .date-picker-display:hover,
.table-controls .table-date-range .date-picker-display:active,
.table-controls .table-date-range .date-picker-display:focus-visible { background:transparent; background-color:transparent; border-color:transparent; box-shadow:none; }
.table-controls .table-date-range .date-picker { min-width:84px; }
.table-controls .table-categorize { display:flex; align-items:flex-start; flex:0 0 auto; }
.table-controls .table-categorize { flex-direction:column; align-items:flex-start; gap:.2rem; }
.table-controls .table-ai-status { display:flex; align-items:center; justify-content:flex-start; }
.table-controls .table-ai-status .ai-status-pill { margin-left:0; padding:0; }
.table-controls .table-categorize .categorize-cluster { padding:0; border:0; background:transparent; border-radius:0; gap:.15rem; box-shadow:none; }
.table-controls .table-categorize .cat-main-row { gap:.2rem; align-items:flex-end; }
.table-controls .table-categorize .categorize-btn.revamp-cat { height:22px; padding:.12rem .32rem; font-size:.66rem; align-self:flex-end; }
.table-controls .table-categorize .ai-pill-toggle.compact { height:22px; padding:.06rem .28rem; align-self:flex-end; }
.table-controls .table-categorize .cat-status-badge { height:22px; padding:.08rem .22rem; font-size:.48rem; align-self:flex-end; }
.table-controls .table-categorize .dropdown-btn.compact.cat-help-btn { height:22px; width:22px; padding:0; border-radius:999px; font-size:.7rem; letter-spacing:0; text-transform:none; line-height:1; justify-content:center; align-self:flex-end; }
.table-controls .table-categorize .dropdown-btn.compact.cat-help-btn:after { content:""; }
.table-controls .table-categorize .cat-status-badge, 
.table-controls .table-categorize .ai-pill-toggle.compact, 
.table-controls .table-categorize .categorize-btn.revamp-cat { line-height:1; }
.table-controls .table-columns { display:flex; flex-wrap:nowrap; gap:.3rem; justify-content:flex-end; align-items:center; width:100%; }
.table-controls .table-columns .col-toggle-btn { height:22px; padding:.12rem .35rem; font-size:.48rem; letter-spacing:.05em; }
.table-controls .table-columns .col-toggle-btn .indicator { width:7px; height:7px; }
.table-controls .table-search-input,
.table-controls .table-date-range label,
.table-controls .table-date-range .date-picker-display,
.table-controls .table-categorize .categorize-btn.revamp-cat,
.table-controls .table-categorize .ai-pill-toggle.compact,
.table-controls .table-categorize .cat-status-badge,
.table-controls .table-categorize .dropdown-btn.compact.cat-help-btn,
.table-controls .table-columns .col-toggle-btn {
  height:22px;
  line-height:1;
  vertical-align:middle;
}
.table-controls .table-date-range label,
.table-controls .table-date-range .date-picker-display,
.table-controls .table-categorize .categorize-btn.revamp-cat,
.table-controls .table-categorize .ai-pill-toggle.compact,
.table-controls .table-categorize .cat-status-badge,
.table-controls .table-categorize .dropdown-btn.compact.cat-help-btn,
.table-controls .table-columns .col-toggle-btn {
  display:inline-flex;
  align-items:center;
}
@media (max-width:900px){
  .table-controls { flex-direction:row; align-items:center; flex-wrap:nowrap; overflow-x:auto; -webkit-overflow-scrolling:touch; position:relative; display:flex; white-space:nowrap; }
  .table-controls:after {
    content:"";
    position:sticky;
    right:0;
    top:0;
    height:100%;
    width:26px;
    margin-left:-26px;
    pointer-events:none;
    background:linear-gradient(90deg, rgba(15,17,21,0), rgba(15,17,21,0.85));
  }
  .table-controls > .table-search,
  .table-controls > .table-categorize,
  .table-controls > .table-columns { flex:0 0 auto; }
  .table-controls .table-search { min-width:max-content; gap:.35rem; }
  .table-controls .table-categorize { margin-top:0; }
  .table-controls .table-categorize .categorize-cluster {
    flex-direction:row !important;
    align-items:center !important;
    width:auto !important;
    padding:0 !important;
  }
  .table-controls .table-categorize .cat-main-row,
  .table-controls .table-categorize .cat-left-group,
  .table-controls .table-categorize .cat-right-group {
    flex-direction:row !important;
    align-items:center !important;
    width:auto !important;
  }
  .table-controls .table-categorize .categorize-btn,
  .table-controls .table-categorize .ai-pill-toggle.compact,
  .table-controls .table-categorize .cat-status-badge {
    width:auto !important;
  }
  .table-controls .table-categorize .cat-main-row { flex-wrap:nowrap; }
  .table-controls .table-columns { justify-content:flex-end; min-width:max-content; margin-left:-2rem; }
  .table-controls .table-date-range label { height:auto; align-items:center; padding:.12rem .18rem; }
  .table-controls .table-date-range .date-picker-display {
    height:auto;
    padding:.1rem .18rem;
    min-width:0;
    background:transparent;
    border:0;
    font-size:.54rem;
    line-height:1.1;
    box-shadow:none;
  }
  .table-controls .table-date-range .date-picker-display:hover { background:transparent; border-color:transparent; }
}

/* Custom date picker component */
.date-picker { position:relative; }
.date-picker.open { z-index:4000; }
.date-picker-display { background:#14191f; border:1px solid #2a3848; padding:.55rem .65rem .5rem; border-radius:8px; font-size:.75rem; letter-spacing:.03em; color:var(--text-base); cursor:pointer; display:inline-flex; align-items:center; gap:.35rem; min-width:120px; justify-content:space-between; }
.date-picker-display:hover { background:#18222b; border-color:#334457; }
.date-picker-display:focus-visible { outline:2px solid #ffb347; outline-offset:2px; }
.date-picker-display .dp-caret { font-size:.6rem; opacity:.7; }
.date-pop { background:#161d25; border:1px solid #24303d; border-radius:12px; padding:.65rem .7rem .7rem; box-shadow:0 10px 28px -8px rgba(0,0,0,.7); width:250px; display:flex; flex-direction:column; gap:.55rem; }
.date-pop-head { display:flex; align-items:center; justify-content:space-between; font-size:.65rem; font-weight:600; letter-spacing:.05em; text-transform:uppercase; color:#ffb347; }
.date-pop-head .nav-btn { background:#19222c; border:1px solid #2c3845; color:#d5dae0; padding:.3rem .45rem .35rem; border-radius:6px; font-size:.7rem; cursor:pointer; }
.date-pop-head .nav-btn:hover { background:#1f2a35; }
.date-pop-head .nav-btn:focus-visible { outline:2px solid #ffb347; outline-offset:2px; }
.month-label { flex:1; text-align:center; }
.weekdays { display:grid; grid-template-columns:repeat(7,1fr); font-size:.55rem; letter-spacing:.06em; text-transform:uppercase; color:#7d92a4; gap:.15rem; }
.weekdays div { text-align:center; padding:.15rem 0 .2rem; }
.days-grid { display:grid; grid-template-columns:repeat(7,1fr); gap:.15rem; }
.day-cell { background:#1b242e; border:1px solid #27323d; border-radius:6px; font-size:.62rem; line-height:1; padding:.4rem 0 .45rem; color:#d4d9df; cursor:pointer; font-weight:600; position:relative; }
.day-cell:hover { background:#22313d; border-color:#314051; }
.day-cell.selected { background:#ffb347; color:#111; border-color:#ffb347; }
.day-cell.selected:hover { background:#ffc66a; }
.day-cell.dim { opacity:.45; }
.day-cell.disabled { opacity:.25; cursor:not-allowed; text-decoration:line-through; }
.day-cell:focus-visible { outline:2px solid #ffe6a6; outline-offset:2px; }
.date-pop-foot { display:flex; justify-content:space-between; margin-top:.2rem; }
.date-pop-foot button { background:#19222c; border:1px solid #2c3845; color:#d5dae0; padding:.35rem .55rem .4rem; border-radius:8px; font-size:.55rem; letter-spacing:.07em; text-transform:uppercase; font-weight:600; cursor:pointer; }
.date-pop-foot button:hover { background:#1f2a35; }
.date-pop-foot button:focus-visible { outline:2px solid #ffb347; outline-offset:2px; }
@media (prefers-reduced-motion: reduce) { .date-pop { transition:none; } }
.clear-filters.inline { margin:0; align-self:flex-end; background:#222e3a; border:1px solid #314051; color:#d5dbe1; padding:.45rem .65rem .5rem; border-radius:8px; font-size:.55rem; letter-spacing:.06em; font-weight:600; text-transform:uppercase; }
.clear-filters.inline:hover { background:#273545; }
.categorize-btn.inline { background:linear-gradient(135deg,#1d2b33 0%,#213240 55%,#1d2b33 100%); position:relative; border:1px solid #2f3c48; color:#e5e9ee; padding:.48rem .75rem .53rem; border-radius:9px; font-size:.55rem; letter-spacing:.07em; font-weight:650; text-transform:uppercase; cursor:pointer; overflow:hidden; box-shadow:0 3px 10px -4px rgba(0,0,0,.55), 0 1px 0 rgba(255,255,255,.05) inset; transition:background .35s, box-shadow .35s, transform .2s, border-color .35s; }
.categorize-btn.inline:before { content:""; position:absolute; inset:0; padding:1px; border-radius:inherit; background:linear-gradient(115deg,rgba(255,179,71,.85),rgba(255,179,71,0) 40%, rgba(51,209,192,.8) 75%, rgba(51,209,192,0) 100%); -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); -webkit-mask-composite:xor; mask-composite:exclude; opacity:.55; pointer-events:none; transition:opacity .4s; }
.categorize-btn.inline:after { content:""; position:absolute; left:-40%; top:0; width:60%; height:100%; background:linear-gradient(90deg,rgba(255,255,255,.0),rgba(255,255,255,.55),rgba(255,255,255,0)); transform:skewX(-25deg) translateX(-120%); opacity:.0; }
.categorize-btn.inline:hover { background:linear-gradient(135deg,#223544 0%,#294153 60%); box-shadow:0 5px 16px -6px rgba(0,0,0,.7), 0 1px 0 rgba(255,255,255,.06) inset; }
.categorize-btn.inline:hover:before { opacity:.75; }
.categorize-btn.inline:hover:after { animation:catSheen 1.4s ease-in-out; }
.categorize-btn.inline:active { transform:translateY(1px); }
.categorize-btn.inline:focus-visible { outline:none; box-shadow:0 0 0 2px #0f1115, 0 0 0 4px #ffb347; }
@keyframes catSheen { 0% { transform:skewX(-25deg) translateX(-120%); opacity:0; } 25% { opacity:.4; } 55% { opacity:.0; } 100% { transform:skewX(-25deg) translateX(250%); opacity:0; } }
@media (prefers-reduced-motion: reduce) { .categorize-btn.inline:hover:after { animation:none; } }
.categorize-btn.inline[disabled] { cursor:progress; opacity:.7; filter:saturate(.4); }
.categorize-btn.inline.needs-action { animation:catAttention 3.5s ease-in-out infinite; }
@keyframes catAttention { 0% { box-shadow:0 0 0 0 rgba(255,179,71,.0), 0 0 0 0 rgba(90,214,125,0); }
 12% { box-shadow:0 0 0 0 rgba(255,179,71,.55), 0 0 0 6px rgba(255,179,71,0.0); }
 26% { box-shadow:0 0 0 2px rgba(255,179,71,.45), 0 0 0 10px rgba(255,179,71,0); }
 40% { box-shadow:0 0 0 1px rgba(255,179,71,.3), 0 0 0 0 rgba(255,179,71,0); }
 100% { box-shadow:0 0 0 0 rgba(255,179,71,0), 0 0 0 0 rgba(255,179,71,0); }}
@media (prefers-reduced-motion: reduce) { .categorize-btn.inline.needs-action { animation:none; } }
/* AI refinement badge (small) */
.ai-refine-indicator { 
  display:inline-flex; align-items:center; justify-content:center;
  font-size:.45rem; line-height:1; font-weight:700; letter-spacing:.08em; 
  background:transparent; color:#5ad67d; padding:.12rem .28rem; border:1px solid #28503d; 
  border-radius:6px; box-shadow:none;
  opacity:0; transform:translateY(-1px) scale(.95); transition:opacity .28s ease, transform .35s ease;
}
.ai-refine-indicator.active { opacity:1; transform:translateY(0) scale(1); animation:none; }
/* Inline AI progress bar */
.ai-progress-wrap { position:relative; display:flex; align-items:center; gap:.6rem; min-height:1.1rem; }
.ai-inline-progress { position:relative; width:120px; height:4px; background:#18242d; border:1px solid #243542; border-radius:3px; overflow:hidden; opacity:0; transform:translateY(2px); transition:opacity .35s ease, transform .35s ease; }
.ai-inline-progress.active { opacity:1; transform:translateY(0); }
.ai-inline-progress.loading { width:90px; }
.ai-inline-progress .bar { position:absolute; inset:0; background:linear-gradient(90deg,rgba(255,179,71,0),#ffb347 35%,#ffb347 65%,rgba(255,179,71,0)); animation:aiSwipe 1.4s cubic-bezier(.4,0,.2,1) infinite; }
.ai-inline-progress.active .bar { animation-duration:1.1s; background:linear-gradient(90deg,rgba(90,214,125,0),#5ad67d 32%,#5ad67d 68%,rgba(90,214,125,0)); }
@keyframes aiSwipe { 0% { transform:translateX(-80%);} 50% { transform:translateX(15%);} 100% { transform:translateX(110%);} }
@media (prefers-reduced-motion: reduce){ .ai-inline-progress .bar { animation:aiSwipe 2.2s linear infinite; } }
/* CategorizeCluster layout */
.categorize-cluster { --gap:0.35rem; background:var(--surface-1); border:1px solid var(--surface-1-border); padding:.35rem .45rem; border-radius:var(--panel-radius); display:flex; flex-direction:column; gap:.25rem; position:relative; box-shadow:none; }
.filter-primary-row.grid2 .primary-right .categorize-cluster { align-self:stretch; }
.filter-primary-row.grid2 .search-composite input.filter-text { height:38px; }
.filter-primary-row.grid2 .primary-right .categorize-cluster .cat-main-row { min-height:38px; }
.filter-primary-row.grid2 .primary-right .categorize-cluster .categorize-btn.revamp-cat { padding:.55rem .85rem .6rem; }
.filter-primary-row.grid2 .primary-right .categorize-cluster .ai-pill-toggle.compact { height:32px; padding:.18rem .65rem; }
.filter-primary-row.grid2 .primary-right .categorize-cluster .cat-status-badge { padding:.28rem .5rem; }
.filter-primary-row.grid2 .primary-right .categorize-cluster .cat-sep { margin:0 .1rem; }
.categorize-cluster:before { content:""; display:none; }
.cat-main-row { display:flex; align-items:center; gap:.3rem; justify-content:space-between; }
.cat-main-row > * { flex:0 0 auto; }
.cat-main-row .cat-sep { flex:0 0 1px; }
.categorize-cluster .cat-left-group,
.categorize-cluster .cat-right-group { display:flex; align-items:center; gap:.3rem; flex-wrap:nowrap; }
.categorize-cluster .cat-left-group .categorize-btn { margin:0; }
.categorize-cluster .consistency-badge-wrap { margin-left:0; }
.cat-foot-row { min-height:.85rem; font-size:.52rem; letter-spacing:.2px; color:var(--text-muted); display:flex; align-items:center; }
.cat-foot-row .cat-foot-msg { animation:fadeIn .35s ease; }
.cat-foot-row .hint { opacity:.75; }
.cat-status-badge { display:inline-flex; align-items:center; gap:.3rem; background:transparent; border:1px solid var(--surface-2-border); padding:.18rem .35rem; border-radius:999px; font-size:.52rem; font-weight:600; letter-spacing:.3px; position:relative; color:var(--text-muted); }
.cat-status-badge .cat-status-dot { width:.4rem; height:.4rem; border-radius:50%; background:var(--chart-positive); box-shadow:none; }
.cat-status-badge .ai-refine-indicator { margin-left:.15rem; }
.cat-refine-slot { width:1.1rem; display:inline-flex; justify-content:flex-start; }
.ai-pill-toggle.compact { height:22px; font-size:.5rem; padding:.08rem .4rem; border-radius:999px; background:#1b2530; border:1px solid #34424f; display:inline-flex; align-items:center; gap:.25rem; position:relative; font-weight:600; letter-spacing:.45px; color:#cbd4db; }
.ai-pill-toggle.compact:hover { background:#22303d; border-color:#3e4f5f; color:#e2e8ee; }
.ai-pill-toggle.compact.active { background:var(--ai-accent-soft); border-color:var(--ai-accent-border); color:var(--ai-accent); }
.ai-pill-toggle.compact .dot { width:.45rem; height:.45rem; border-radius:50%; background:var(--text-faint); box-shadow:none; }
.ai-pill-toggle.compact.active .dot { background:var(--ai-accent); }
.ai-pill-label { text-transform:uppercase; }
.revamp-cat.large.inline.needs-action { box-shadow:0 0 0 1px rgba(255,179,71,.45); }
.cat-sep { width:1px; align-self:stretch; background:rgba(255,255,255,.06); }
.cat-spinner { width:.9rem; height:.9rem; border:.14rem solid #284154; border-top-color:#ffb347; border-radius:50%; animation:spin .8s linear infinite; }
@keyframes spin { to { transform:rotate(360deg); } }
.categorize-cluster .categorize-btn { position:relative; }
.categorize-cluster .categorize-btn.revamp-cat { background:var(--surface-2); border:1px solid var(--surface-2-border); color:var(--text-strong); text-transform:none; letter-spacing:.02em; box-shadow:none; padding:.3rem .5rem; font-size:.72rem; }
.categorize-cluster .categorize-btn.revamp-cat .cat-btn-bg,
.categorize-cluster .categorize-btn.revamp-cat .cat-btn-glow { display:none; }
.categorize-cluster .categorize-btn.revamp-cat.is-uncategorize { background:var(--surface-2); border-color:var(--surface-2-border); }
@media (max-width: 880px){
  .categorize-cluster { padding:.3rem .4rem; }
  .cat-foot-row { font-size:.5rem; }
  .ai-pill-toggle.compact { height:20px; }
  .categorize-cluster .categorize-btn.revamp-cat { padding:.26rem .45rem; font-size:.7rem; }
}
@keyframes aiRefinePulse { 0%,100% { filter:brightness(1); opacity:.85; } 50% { filter:brightness(1.15); opacity:1; } }
@media (prefers-reduced-motion: reduce){ .ai-refine-indicator { animation:none; } }
/* Ultra Upload button enhancement */
.primary-cta.primary-cta--ultra { position:relative; overflow:hidden; --mx:.5; --my:.5; background:radial-gradient(circle at calc(var(--mx)*100%) calc(var(--my)*100%), color-mix(in srgb, var(--accent-hover) 20%, var(--accent) 80%) 0%, var(--accent) 50%) !important; color:color-mix(in srgb, var(--text-strong) 95%, #000 5%); padding:.92rem 1.28rem .95rem; border-radius:16px; }
.primary-cta.primary-cta--ultra:before { content:""; position:absolute; inset:-1px; padding:1px; border-radius:inherit; background:conic-gradient(from 0deg at calc(var(--mx)*100%) calc(var(--my)*100%), color-mix(in srgb,var(--accent-soft) 90%, rgba(255,255,255,.95) 10%), rgba(255,255,255,0) 25%, color-mix(in srgb,var(--accent-soft) 60%, rgba(255,255,255,.4) 40%)); -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); -webkit-mask-composite:xor; mask-composite:exclude; opacity:.55; pointer-events:none; transition:opacity .6s; }
.primary-cta.primary-cta--ultra:after { content:""; position:absolute; inset:0; background:radial-gradient(circle at calc(var(--mx)*100%) calc(var(--my)*100%), color-mix(in srgb,var(--accent-soft) 70%, rgba(255,255,255,0.4) 30%), rgba(255,255,255,0) 60%); mix-blend-mode:overlay; opacity:.65; pointer-events:none; transition:opacity .35s; }
.primary-cta.primary-cta--ultra:hover:before { opacity:.85; }
.primary-cta.primary-cta--ultra:hover:after { opacity:.85; }
.primary-cta.primary-cta--ultra .orb-icon { filter:drop-shadow(0 0 6px color-mix(in srgb,var(--accent-soft) 70%, rgba(255,255,255,.2) 30%)); }
.primary-cta.primary-cta--ultra:active { transform:translateY(1px) scale(.995); }
.primary-cta.primary-cta--ultra { box-shadow:0 12px 30px -10px color-mix(in srgb,var(--accent) 40%, #000 60%), 0 6px 16px -6px rgba(0,0,0,.65), 0 0 0 1px rgba(255,255,255,.06) inset; }
.primary-cta.primary-cta--ultra:hover { box-shadow:0 14px 34px -12px color-mix(in srgb,var(--accent) 50%, #000 50%), 0 8px 20px -8px rgba(0,0,0,.7), 0 0 0 1px rgba(255,255,255,.08) inset; }
@media (prefers-reduced-motion: reduce) { .primary-cta.primary-cta--ultra { transition:none; } }
.primary-cta.primary-cta--ultra { perspective:600px; }
.primary-cta.primary-cta--ultra span, .primary-cta.primary-cta--ultra .orb-icon { position:relative; z-index:2; }
.primary-cta.primary-cta--ultra { --tiltX: calc((var(--my) - .5) * -10deg); --tiltY: calc((var(--mx) - .5) * 10deg); transform:rotateX(var(--tiltX)) rotateY(var(--tiltY)); transition:transform .12s ease, box-shadow .32s, background-position .9s; }
.primary-cta.primary-cta--ultra:hover { transform:rotateX(var(--tiltX)) rotateY(var(--tiltY)) translateY(-2px); }
.primary-cta.primary-cta--ultra:focus-visible { box-shadow: var(--focus-ring); }
.primary-cta.primary-cta--ultra .particles { position:absolute; inset:0; pointer-events:none; }
.primary-cta.primary-cta--ultra .particles i { position:absolute; width:6px; height:6px; background:color-mix(in srgb,var(--accent-soft) 80%, rgba(255,255,255,.2) 20%); border-radius:50%; top:50%; left:50%; animation:uploadDrift 3.2s linear infinite; opacity:0; }
.primary-cta.primary-cta--ultra:before { content:""; position:absolute; inset:-1px; padding:1px; border-radius:inherit; background:conic-gradient(from 0deg at calc(var(--mx)*100%) calc(var(--my)*100%), rgba(255,255,255,.8), rgba(255,255,255,0) 25%, rgba(255,255,255,.4) 40%, rgba(255,255,255,0) 60%, rgba(255,255,255,.7) 75%, rgba(255,255,255,0) 100%); -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); -webkit-mask-composite:xor; mask-composite:exclude; opacity:.55; pointer-events:none; transition:opacity .6s; }
.primary-cta.primary-cta--ultra:after { content:""; position:absolute; inset:0; background:radial-gradient(circle at calc(var(--mx)*100%) calc(var(--my)*100%), rgba(255,255,255,.4), rgba(255,255,255,0) 60%); mix-blend-mode:overlay; opacity:.65; pointer-events:none; transition:opacity .35s; }
.primary-cta.primary-cta--ultra:hover:before { opacity:.85; }
.primary-cta.primary-cta--ultra:hover:after { opacity:.85; }
.primary-cta.primary-cta--ultra .orb-icon { filter:drop-shadow(0 0 6px rgba(255,255,255,.55)); }
.primary-cta.primary-cta--ultra:active { transform:translateY(1px) scale(.98); }
.primary-cta.primary-cta--ultra { box-shadow:0 10px 24px -8px rgba(255,136,0,.55), 0 4px 12px -4px rgba(0,0,0,.7), 0 0 0 1px rgba(255,255,255,.15) inset; }
.primary-cta.primary-cta--ultra:hover { box-shadow:0 12px 30px -10px rgba(255,140,10,.65), 0 6px 16px -6px rgba(0,0,0,.75), 0 0 0 1px rgba(255,255,255,.25) inset; }
@media (prefers-reduced-motion: reduce) { .primary-cta.primary-cta--ultra { transition:none; } }
.primary-cta.primary-cta--ultra { perspective:600px; }
.primary-cta.primary-cta--ultra span, .primary-cta.primary-cta--ultra .orb-icon { position:relative; z-index:2; }
.primary-cta.primary-cta--ultra { --tiltX: calc((var(--my) - .5) * -14deg); --tiltY: calc((var(--mx) - .5) * 14deg); transform:rotateX(var(--tiltX)) rotateY(var(--tiltY)); transition:transform .12s ease, box-shadow .4s, background-position 1s; }
.primary-cta.primary-cta--ultra:hover { transform:rotateX(var(--tiltX)) rotateY(var(--tiltY)) translateY(-2px); }
.primary-cta.primary-cta--ultra:focus-visible { box-shadow:0 0 0 3px #0f1115, 0 0 0 6px #ffe6a6; }
.primary-cta.primary-cta--ultra .particles { position:absolute; inset:0; pointer-events:none; }
.primary-cta.primary-cta--ultra .particles i { position:absolute; width:6px; height:6px; background:rgba(255,255,255,.85); border-radius:50%; top:50%; left:50%; animation:uploadDrift 3.2s linear infinite; opacity:0; }
@keyframes uploadDrift { 0% { transform:translate(-50%,-50%) scale(.3); opacity:0; } 10% { opacity:.8; } 60% { opacity:.4; } 100% { transform:translate(calc(-50% + (var(--dx)*1px)), calc(-50% + (var(--dy)*1px))) scale(0); opacity:0; } }
.type-chips { display:flex; flex-wrap:wrap; gap:.5rem; }
.chip { background:var(--surface-2); color:#d4d9df; border:1px solid var(--surface-2-border); padding:.35rem .65rem; border-radius:16px; font-size:.7rem; letter-spacing:.05em; text-transform:uppercase; cursor:pointer; transition:all .25s, transform 150ms ease; box-shadow:0 1px 2px rgba(0,0,0,0.3); }
.chip { min-height:34px; }
.chip.active { background:#ffb347; color:#111; border-color:#ffb347; box-shadow:0 2px 6px rgba(255,179,71,0.4); }
.chip:hover { transform:translateY(-2px); box-shadow:0 4px 10px rgba(0,0,0,0.5); }
.clear-filters { background:var(--surface-2); border:1px solid var(--surface-2-border); color:#d5dbe1; padding:.35rem .7rem; border-radius:8px; font-size:.65rem; letter-spacing:.05em; cursor:pointer; text-transform:uppercase; font-weight:600; margin-top:.4rem; box-shadow:0 1px 2px rgba(0,0,0,0.3); transition:background-color 200ms ease, transform 150ms ease, box-shadow 200ms ease; }
.clear-filters:hover { background:var(--surface-3); transform:translateY(-1px); box-shadow:0 4px 10px rgba(0,0,0,0.5); }

/* Column toggles */
.col-toggle-group { display:flex; flex-wrap:wrap; gap:.4rem .65rem; margin-top:.35rem; font-size:.65rem; }
.col-toggle { display:inline-flex; align-items:center; gap:.25rem; background:#19222c; padding:.3rem .55rem .35rem; border:1px solid #2a3542; border-radius:999px; font-weight:600; letter-spacing:.06em; text-transform:uppercase; cursor:pointer; transition:background .25s, border-color .25s, color .25s; }
.col-toggle.off { opacity:.55; filter:saturate(.4); }
.col-toggle input { accent-color:#ffb347; }
.col-toggle:hover { background:#1f2a35; }
/* New pill toggle buttons (replacing checkbox version) */
.col-toggle-btn { position:relative; display:inline-flex; align-items:center; gap:.4rem; background:#182029; border:1px solid #293640; color:#bfc7cd; padding:.42rem .7rem .46rem; border-radius:999px; font-size:.55rem; font-weight:650; letter-spacing:.07em; text-transform:uppercase; cursor:pointer; line-height:1; transition:background .35s, border-color .35s, color .35s, box-shadow .4s; }
.col-toggle-btn .indicator { width:9px; height:9px; border-radius:50%; background:radial-gradient(circle at 35% 35%, #7a8995, #55616b); box-shadow:0 0 0 0 rgba(255,179,71,0); transition:background .35s, transform .35s, box-shadow 1s; }
.col-toggle-btn.active { background:linear-gradient(135deg,#253027 0%,#2d3a31 60%); border-color:#355041; color:#e6ecef; box-shadow:0 4px 12px -5px rgba(0,0,0,.55), 0 0 0 1px rgba(255,255,255,.04) inset; }

/* Chart-scoped compact sizing for Flow/Sankey toggle only */
.charts-row.four-charts.unified .chart .col-toggle-btn {
  padding:.12rem .38rem .06rem !important; /* slight downward bias for optical centering */
  font-size:.40rem !important;
  letter-spacing:.05em !important;
  gap:.26rem !important;
  min-height:16px !important; /* rely on min-height + flex centering */
  display:inline-flex !important;
  align-items:center !important;
  line-height:1 !important;
  color:#ffb347 !important; /* yellow text */
}
.charts-row.four-charts.unified .chart .col-toggle-btn .indicator { display:block; align-self:center; position:relative; top:.5px; }
.charts-row.four-charts.unified .chart .col-toggle-btn:hover,
.charts-row.four-charts.unified .chart .col-toggle-btn:focus,
.charts-row.four-charts.unified .chart .col-toggle-btn.active {
  color:#ffb347 !important; /* keep yellow on active/hover */
}
.charts-row.four-charts.unified .chart .col-toggle-btn .indicator {
  width:5px !important;
  height:5px !important;
}
.col-toggle-btn.active .indicator { background:radial-gradient(circle at 35% 35%, #ffb347, #ff8a2a); transform:scale(1.25); box-shadow:0 0 0 0 rgba(255,179,71,.5); animation:colPulse 2.6s ease-in-out infinite; }
@keyframes colPulse { 0% { box-shadow:0 0 0 0 rgba(255,179,71,.55);} 60% { box-shadow:0 0 0 6px rgba(255,179,71,0);} 100% { box-shadow:0 0 0 0 rgba(255,179,71,0);} }
.col-toggle-btn:hover { background:#1e2a33; border-color:#32414d; }
.col-toggle-btn:focus-visible { outline:2px solid #ffb347; outline-offset:2px; }
.col-toggle-btn:not(.active) { opacity:.75; }
.col-toggle-btn:not(.active):hover { opacity:1; }
@media (prefers-reduced-motion: reduce){ .col-toggle-btn.active .indicator { animation:none; } }

/* Unparsed lines block */
.unparsed-block { margin:1.2rem 0 0; }
.unparsed-toggle { background:var(--surface-2); border:1px solid var(--surface-2-border); color:var(--text-strong); padding:.45rem .75rem; border-radius:8px; font-size:.65rem; letter-spacing:.05em; text-transform:uppercase; font-weight:600; cursor:pointer; box-shadow:0 1px 3px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.03) inset; transition:background-color 200ms ease, transform 150ms ease, box-shadow 200ms ease; }
.unparsed-toggle:hover { background:var(--surface-3); transform:translateY(-1px); box-shadow:0 4px 10px rgba(0,0,0,0.5); }
.unparsed-lines { margin:.6rem 0 0; background:var(--surface-1); border:1px solid var(--surface-1-border); padding:.7rem .8rem; border-radius:8px; font-size:.64rem; line-height:1.35; max-height:200px; overflow:auto; color:#d0d5db; box-shadow:0 1px 3px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.03) inset; }


.charts-row { display:flex; flex-direction:row; flex-wrap:wrap; gap:var(--card-gap); margin:0 0 var(--section-gap); overflow:visible; padding-bottom:0; }

/* Force four charts per row when space allows */
.charts-row.four-charts { flex-wrap:nowrap; gap:0; }
.charts-row.four-charts .chart { flex:1 1 auto; min-width:0; }

/* Remove previous fixed flex-basis that could constrain width */
.charts-row.four-charts .chart { width:100%; }

/* Minimal padding inside unified charts to maximize chart area */
.charts-row.four-charts.unified .chart { padding:.15rem .2rem; }
.charts-row.four-charts .chart { padding:0; border:none; border-radius:0; position:relative; }
.charts-row.four-charts .chart + .chart:before { content:""; position:absolute; left:0; top:0; bottom:0; width:1px; background:rgba(80,150,220,0.30); opacity:.6; pointer-events:none; }
.charts-row.four-charts.unified { background:linear-gradient(160deg, rgba(25,33,43,0.92) 0%, rgba(12,16,22,0.95) 100%); border:1px solid rgba(255,255,255,0.08); border-radius:var(--panel-radius); padding:0; display:flex; justify-content:flex-start; box-shadow:0 6px 12px -8px rgba(0,0,0,.7), 0 1px 0 rgba(255,255,255,.02) inset; }
.charts-row.four-charts.unified .chart { background:transparent; }
.charts-row.four-charts.unified .chart { flex:1 1 0; min-width:0; max-width:100%; }
/* Single chart: 50% width and centered */
.charts-row.four-charts.unified .chart:only-child { flex:0 0 50%; max-width:50%; }
.charts-row.four-charts.unified:has(.chart:only-child) { justify-content:center; }
/* Minimal padding inside unified charts to maximize chart area */
.charts-row.four-charts.unified .chart { padding:.15rem .2rem; }
.charts-row.four-charts .chart:first-child { border-top-left-radius:0; border-bottom-left-radius:0; }
.charts-row.four-charts .chart:last-child { border-top-right-radius:0; border-bottom-right-radius:0; }

/* If viewport narrower than 1400px, allow wrap to prevent overflow */
@media (max-width: 1399px) {
  .charts-row.four-charts { flex-wrap:wrap; gap:.12rem; }
  .charts-row.four-charts .chart { flex:1 1 calc(50% - .12rem); border-radius:var(--panel-radius); padding:0; }
  .charts-row.four-charts .chart + .chart:before { left:0; top:0; bottom:0; background:rgba(90,170,240,0.32); opacity:.55; }
}

@media (max-width: 900px) {
  .charts-row.four-charts .chart { flex:1 1 100%; }
}
.chart { background:linear-gradient(160deg, rgba(25,33,43,0.92) 0%, rgba(12,16,22,0.95) 100%); border:1px solid rgba(255,255,255,0.08); border-radius:var(--panel-radius); padding:.25rem .3rem .25rem; flex:1 0 340px; display:flex; flex-direction:column; box-shadow:0 6px 12px -8px rgba(0,0,0,.7), 0 1px 0 rgba(255,255,255,.02) inset; transition:box-shadow 200ms ease, border-color 200ms ease; position:relative; z-index:2; }
.chart:hover { border-color:rgba(255,255,255,0.16); box-shadow:0 10px 18px -12px rgba(0,0,0,.75), 0 1px 0 rgba(255,255,255,.04) inset; }
.chart:hover, .chart:focus-within { z-index:6; }
.chart .plot-inner { flex:1 1 auto; }
.chart .plot-inner { width:100%; height:100%; }
.chart-info { position:absolute; top:6px; left:8px; z-index:100; display:inline-flex; align-items:center; justify-content:center; width:16px; height:16px; font-size:.55rem; font-weight:600; border-radius:4px; background:var(--surface-2); color:var(--accent); cursor:pointer; border:1px solid var(--surface-2-border); box-shadow:0 1px 3px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.03) inset; transition:transform 150ms ease, box-shadow 150ms ease, background-color 150ms ease; }
.chart-info:hover { transform:scale(1.1); background:var(--surface-3); box-shadow:0 2px 6px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,179,71,0.1) inset; }
.chart-info:focus-visible { outline:2px solid var(--accent); outline-offset:2px; }
.chart-info .tooltip { position:absolute; left:0; top:115%; transform:translateY(4px); background:var(--surface-2); color:var(--text-base); font-size:.56rem; line-height:1.25; width:190px; padding:.45rem .5rem .5rem; border:1px solid var(--surface-2-border); border-radius:8px; box-shadow:0 10px 24px -8px rgba(0,0,0,.7), 0 0 0 1px rgba(255,255,255,0.06) inset; opacity:0; pointer-events:none; transition:opacity .2s, transform .2s; z-index:10000; }
.chart-info.open .tooltip { opacity:1; transform:translateY(0); pointer-events:auto; }

@media (max-width: 720px) {
  .chart-info .tooltip {
    position:fixed;
    left:12px !important;
    right:12px !important;
    bottom:16px;
    top:auto;
    transform:none !important;
    width:calc(100vw - 24px) !important;
    max-width:calc(100vw - 24px) !important;
    min-width:calc(100vw - 24px) !important;
    max-height:50vh;
    overflow:auto;
    font-size:.5rem;
    line-height:1.18;
    padding:.35rem .4rem .4rem;
    box-sizing:border-box;
    inset-inline:12px !important;
  }
}

@media (max-width: 480px) {
  .chart-info .tooltip {
    bottom:12px;
    left:8px !important;
    right:8px !important;
    width:calc(100vw - 16px) !important;
    max-width:calc(100vw - 16px) !important;
    min-width:calc(100vw - 16px) !important;
    max-height:44vh;
    font-size:.48rem;
    inset-inline:8px !important;
  }
}

@media (max-width: 720px) {
  .js-plotly-plot .modebar { display:none !important; }
  .chart.modebar-active .js-plotly-plot .modebar { display:flex !important; }
}

/* Chart toggle panel (stacked checkboxes) */
.chart-toggle-panel { position:absolute; bottom:6px; left:8px; display:flex; flex-direction:column; gap:3px; background:rgba(20,26,34,0.85); -webkit-backdrop-filter:blur(12px) saturate(130%); backdrop-filter:blur(12px) saturate(130%); border:1px solid var(--surface-2-border); padding:3px 5px 4px; border-radius:7px; font-size:.50rem; letter-spacing:.06em; z-index:30; box-shadow:0 2px 8px -5px rgba(0,0,0,.45), 0 0 0 1px rgba(255,255,255,0.03) inset; pointer-events:auto; transition:background 200ms ease, border-color 200ms ease, transform 150ms ease; }
.chart-toggle-panel:hover { background:rgba(26,32,42,0.9); border-color:var(--surface-3-border); transform:translateY(-1px); }
.chart-toggle-panel label { font-size:.50rem; }
.chart-toggle-panel label { display:flex; align-items:center; gap:6px; font-weight:600; text-transform:uppercase; color:var(--text-base); cursor:pointer; line-height:1; }
.chart-toggle-panel label.disabled { opacity:.45; cursor:not-allowed; }
.chart-toggle-panel input[type=checkbox] { width:14px; height:14px; accent-color: var(--accent); cursor:pointer; }
.chart-toggle-panel input[type=checkbox]:focus-visible { outline:var(--focus-ring); outline-offset:2px; }
.chart-toggle-panel .hint { font-size:.5rem; letter-spacing:.08em; opacity:.65; }

/* Themed Plotly unified hover vertical guideline (override default white) */
/* Plotly unified hover guideline theming */
.js-plotly-plot .plotly .hoverlayer .hoverline,
.js-plotly-plot .hoverlayer .hoverline,
.js-plotly-plot .hoverlayer .spikeline { /* include spikeline fallback */
  stroke: rgba(255,179,71,0.45) !important;
  stroke-width: 2px !important;
  stroke-dasharray: 4 5;
  vector-effect: non-scaling-stroke;
  paint-order: stroke;
  filter: drop-shadow(0 0 2px rgba(255,179,71,0.55));
}

/* Chart tooltip keyword highlights */
.tooltip .kw-accent, .chart-info .tooltip .kw-accent { color:#ffb347; font-weight:650; }
.tooltip .kw-risk, .chart-info .tooltip .kw-risk { color:#ff6b6b; font-weight:650; }
.tooltip .kw-positive, .chart-info .tooltip .kw-positive { color:#5ad67d; font-weight:650; }
.tooltip .kw-neutral, .chart-info .tooltip .kw-neutral { color:#89a4b7; font-weight:600; }

.table-wrapper { background:#14191f; border:1px solid #27313f; border-radius:var(--panel-radius); padding:var(--container-pad-y) var(--container-pad-x); box-shadow:0 2px 4px rgba(0,0,0,.4); position:relative; z-index:1; margin-bottom:var(--section-gap); }
table { width:100%; border-collapse:collapse; font-size:.82rem; table-layout:fixed; }
thead th { text-align:left; font-weight:700; padding:.45rem .5rem; background:#1f2833; position:sticky; top:0; z-index:2; font-size:.82rem; color:var(--text-strong); }

/* Keyword highlight used in instructional copy */
.kw { color: var(--accent); font-weight:700; }
thead th.sortable { cursor:pointer; user-select:none; transition:background-color 200ms ease, color 200ms ease; }
thead th.sortable:hover { background:var(--surface-2); color:var(--text-strong); }
thead th.sortable:active { background:var(--surface-3); }
thead th.sortable:focus-visible { outline:2px solid var(--accent); outline-offset:-2px; }
tbody td { padding:.45rem .5rem; border-top:1px solid rgba(255,255,255,0.06); vertical-align:middle; transition:background-color 150ms ease; }
/* Enforce uniform transaction row height */
.txn-table tbody tr { height:32px; }
.txn-table tbody td { line-height:1.1; }
tbody tr:hover { background:var(--surface-2); }
tbody tr { transition:background-color 150ms ease; }
td.neg { color:#ff6b6b; font-weight:600; }
td.pos { color:#5ad67d; font-weight:600; }
.txn-table th.col-amount, .txn-table th.col-balance,
.txn-table td.col-amount, .txn-table td.col-balance { text-align:center; }
.txn-table td.col-amount.num, .txn-table td.col-balance.num { text-align:center; }
.txn-table td.desc { white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.txn-table td.num { text-align:right; font-variant-numeric:tabular-nums; }
.txn-table .neg { font-weight:600; }
.txn-table .pos { font-weight:600; }
.match-highlight { background:rgba(255,179,71,.25); color:#ffe0a8; padding:0 2px; border-radius:3px; animation:highlightPulse 2s ease-in-out infinite; }
@keyframes highlightPulse { 0%, 100% { background:rgba(255,179,71,.25); } 50% { background:rgba(255,179,71,.35); } }

/* Virtualization spacer helper */
.virtual-spacer td { padding: 0 !important; border: 0 !important; height: inherit !important; }

/* Screen-reader only utility */
.sr-only { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0 0 0 0); white-space:nowrap; border:0; }
.truncate-note { margin-top:.6rem; font-size:.7rem; opacity:.6; }

::-webkit-scrollbar { width:10px; height:10px; }
::-webkit-scrollbar-track { background:#101418; }
::-webkit-scrollbar-thumb { background:#25303c; border-radius:6px; }
::-webkit-scrollbar-thumb:hover { background:#314051; }

/* Removed conflicting anchor color override (previously set to #61dafb) to keep consistent accent link palette. */

/* Cover page */
.cover { background:linear-gradient(145deg,var(--bg-1,#131a23) 0%,var(--bg-2,#0f1115) 60%); border:1px solid var(--panel-border,#1f2a36); padding:1.7rem 1.6rem 1.9rem; border-radius:16px; margin-top:1rem; box-shadow:0 10px 30px -12px rgba(0,0,0,.55), 0 4px 8px rgba(0,0,0,.35); position:relative; overflow:hidden; }
.cover:before { content:""; position:absolute; inset:0; background:radial-gradient(circle at 82% 14%, rgba(255,179,71,.12), transparent 55%); pointer-events:none; }
.cover h1.cover-global-title { margin:0 auto .8rem; font-size:2rem; max-width:880px; text-align:center; letter-spacing:.28px; background:linear-gradient(90deg,var(--accent),var(--accent-hover)); -webkit-background-clip:text; background-clip:text; color:transparent; font-weight:700; line-height:1.06; }
@media (min-width:1100px){ .cover h1.cover-global-title { font-size:2.5rem; } }
.global-tagline { max-width:920px; margin:0 auto 1.1rem; text-align:center; font-size:1rem; line-height:1.45; opacity:.88; }
.cover-left-title { margin:0 0 .9rem; font-size:1rem; letter-spacing:.1em; text-transform:uppercase; font-weight:650; background:linear-gradient(90deg,#ffe6a6,#ffb347 70%); -webkit-background-clip:text; background-clip:text; color:transparent; }
.cover h1 { text-transform:none; }
.cover .tagline { font-size:.98rem; max-width:780px; line-height:1.42; opacity:.88; margin:0 0 .9rem; }
.cover-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:var(--card-gap-wide); align-items:start; }
.cover-left { display:flex; flex-direction:column; gap:.45rem; }
.cover-left .cta-row { margin-top:.2rem; }

/* Instructional accordion on cover */
.instruction-compact { display:flex; flex-direction:column; gap:.4rem; margin:.4rem 0 .6rem; }
.instruction-accordion {
  display: grid;
  gap: .4rem;
  margin: .2rem 0 .5rem;
}

/* Recent (resume) card on cover */
.recent-card {
  background: var(--surface-1);
  border: 1px solid var(--surface-1-border);
  border-radius: 12px;
  padding: .7rem .9rem;
  box-shadow: 0 1px 3px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.03) inset;
  display:flex; flex-direction:column; gap:.45rem;
  margin: .2rem 0 .4rem 0;
  color: var(--text-strong);
  font-size: .92rem;
  transition: box-shadow 200ms ease, transform 150ms ease;
}
.recent-card:hover {
  box-shadow: 0 4px 12px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,255,255,0.05) inset;
  transform: translateY(-1px);
}
.recent-card-head { display:flex; align-items:center; justify-content:space-between; gap:.6rem; }
.recent-title {
  font-weight: 600;
  letter-spacing: .03em;
  color: #ffe6a6;
  font-size: .93rem;
}
.resume-btn {
  margin-left: auto;
  background: linear-gradient(90deg, #ffb347 0%, #ffd86b 100%);
  color: #181f29;
  font-weight: 700;
  border: none;
  border-radius: 7px;
  padding: .22rem .7rem;
  font-size: .91rem;
  cursor: pointer;
  box-shadow: 0 1.5px 0 #ffe6a6 inset;
  transition: background .18s, color .18s;
}
.resume-btn:hover, .resume-btn:focus-visible {
  background: linear-gradient(90deg, #ffd86b 0%, #ffb347 100%);
  color: #111;
}
/* Make clear button in Recent card match the theme (secondary action) */
.recent-card .clear-all-btn {
  margin-left: 0.5rem;
  background: linear-gradient(135deg,#19222c 0%,#202b37 70%);
  border: 1px solid var(--surface-border);
  color: var(--text-strong);
  padding: .45rem .8rem .5rem;
  font-size: .85rem;
  letter-spacing: .06em;
  text-transform:uppercase;
  font-weight:600;
  border-radius:8px;
  cursor:pointer;
  box-shadow:0 3px 8px -6px rgba(0,0,0,.55);
  transition: background .18s ease, box-shadow .18s ease, transform .12s;
}
.recent-card .clear-all-btn:hover {
  background: linear-gradient(135deg,#1f2a35 0%,#273544 70%);
}
.recent-card .clear-all-btn:focus-visible { box-shadow: var(--focus-ring); outline:none; }

.recent-list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: .07rem;
}
.recent-list-item {
  display: flex;
  align-items: center;
  gap: .4rem;
  padding: .05rem 0;
  font-size: .89rem;
}
.recent-filename {
  font-weight: 500;
  color: #ffe6a6;
  max-width: 12em;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.recent-meta {
  color: #bfc7d5;
  font-size: .81rem;
  margin-left: .5rem;
  opacity: .82;
}
.instruction-accordion .ia-item {
  background: var(--surface-1);
  border: 1px solid var(--surface-1-border);
  border-radius: 13px;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.03) inset;
  transition: box-shadow 200ms ease, border-color 200ms ease, background-color 200ms ease, transform 150ms ease;
}
.instruction-accordion .ia-item:focus-within,
.instruction-accordion .ia-item:hover {
  border-color: var(--accent);
  background: var(--surface-2);
  box-shadow: 0 4px 12px rgba(255,179,71,0.2), 0 0 0 1px rgba(255,179,71,0.1) inset;
  transform: translateY(-1px);
}
.instruction-accordion .dropdown-btn.wide {
  width: 100%;
  text-align: left;
  padding-left: 1.1rem;
  padding-right: 2.1rem;
  border-radius: 10px 10px 0 0;
  background: linear-gradient(90deg, #232e3a 0%, #181f29 100%);
  border: none;
  color: #ffe6a6;
  font-size: .97rem;
  font-weight: 700;
  letter-spacing: .04em;
  box-shadow: none;
  transition: background .22s, color .22s;
}
.instruction-accordion .dropdown-btn.wide .step-index {
  margin-right: .55rem;
  background: #ffb347;
  color: #181f29;
  border-radius: 6px;
  padding: .18rem .5rem .22rem;
  font-size: .68rem;
  font-weight: 700;
  letter-spacing: .06em;
}
.instruction-accordion .dropdown-btn.wide.open {
  background: linear-gradient(90deg, #2a3643 0%, #232e3a 100%);
  color: #fffbe6;
}
.instruction-accordion .ia-body {
  padding: .85rem 1.15rem 1.05rem;
  color: #e6e9ee;
  font-size: .93rem;
  line-height: 1.5;
  border-top: 1.5px solid #232e3a;
  background: linear-gradient(120deg, #181f29 0%, #151a22 100%);
}
.instruction-accordion .ia-body .tips {
  margin: .55rem 0 0;
  font-size: .81rem;
  opacity: .89;
  color: #ffe6a6;
}
.instruction-accordion .ia-body .tips li {
  margin: .19rem 0;
  color: #e6e9ee;
}
.cover-left .primary-actions { margin-top:.5rem; }
@media (min-width:1000px){ .cover-left, .cover-right { padding-top:.2rem; } }
.help-hints { list-style:none; margin:.2rem 0 0; padding:0; display:flex; flex-wrap:wrap; gap:.55rem .9rem; font-size:.6rem; letter-spacing:.08em; text-transform:uppercase; opacity:.75; }
.cover-right { display:flex; flex-direction:column; gap:.5rem; }
.cover-right .benefits-heading { margin:.15rem 0 .4rem; line-height:1.05; font-size:0.95rem; text-transform:uppercase; letter-spacing:.12em; font-weight:700; background:linear-gradient(90deg,var(--accent-warm,#ffe6a6),var(--accent,#ffb347) 70%); -webkit-background-clip:text; background-clip:text; color:transparent; }
/* Subtle vertical divider between cover columns (only when multi-column) */
@media (min-width: 900px){
  .cover-grid.divided { position:relative; }
  .cover-grid.divided:before { content:""; position:absolute; top:0; bottom:0; left:50%; width:1px; background:linear-gradient(to bottom, rgba(255,255,255,0) 0%, rgba(255,255,255,0.08) 12%, rgba(255,255,255,0.12) 50%, rgba(255,255,255,0.08) 88%, rgba(255,255,255,0) 100%); pointer-events:none; transform:translateX(-50%); }
  /* Increase internal side padding so divider breathes */
  .cover-left { padding-right:1.2rem; }
  .cover-right { padding-left:1.2rem; }
}
@media (max-width: 899.9px){ .cover-grid.divided:before { display:none; } }

/* Fine-tune large screen vertical rhythm */
@media (min-width:1200px){
  .cover-right { margin-top:.25rem; }
}
.supported { font-size:.66rem; background:#161d25; border:1px solid #24303d; padding:.55rem .7rem; border-radius:10px; line-height:1.35; }
.supported .muted { opacity:.6; }
.dev-card { background:#161d25; border:1px solid #24303d; padding:.65rem .75rem .7rem; border-radius:14px; margin-top:.2rem; font-size:.7rem; line-height:1.35; display:flex; flex-direction:column; gap:.4rem; box-shadow:0 2px 4px rgba(0,0,0,.35); }
.dev-card h2 { margin:0; font-size:.78rem; letter-spacing:.08em; text-transform:uppercase; font-weight:700; color:#ffb347; }
.dev-links { margin:0; display:flex; gap:.55rem; flex-wrap:wrap; align-items:center; }
.dev-link { display:inline-block; font-size:.62rem; letter-spacing:.08em; text-transform:uppercase; font-weight:600; background:#19222c; border:1px solid #2c3743; padding:.45rem .7rem .5rem; border-radius:8px; color:#d6dbe0; text-decoration:none; transition:background .25s, border-color .25s, color .25s; }
.dev-link:hover { background:#1f2a35; color:#fff; }

/* Compact variant for Recent card clear button */
.recent-card .clear-all-btn.small {
  padding: .28rem .5rem .32rem;
  font-size: .72rem;
  border-radius: 8px;
  display:inline-flex;
  align-items:center;
  gap: .45rem;
}
.recent-card .clear-all-btn.small .clear-icon { display:inline-block; width:14px; height:14px; color:var(--text-base); }
.recent-card .clear-all-btn.small .clear-label { display:inline-block; color:var(--text-base); font-weight:700; }
.recent-card .clear-all-btn.small:hover .clear-icon, .recent-card .clear-all-btn.small:hover .clear-label { color:var(--text-strong); }
.recent-card .clear-all-btn.small:focus-visible { box-shadow: var(--focus-ring); }
.skip-link { position:absolute; left:-999px; top:auto; width:1px; height:1px; overflow:hidden; }
.skip-link:focus { position:static; width:auto; height:auto; background:#ffb347; color:#111; padding:.4rem .6rem; border-radius:6px; font-size:.65rem; font-weight:600; }
.info-modal { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:1500; }
.info-backdrop { position:absolute; inset:0; background:rgba(0,0,0,.55); backdrop-filter:blur(3px); }
.info-content { position:relative; z-index:2; background:#161d25; border:1px solid #24303d; border-radius:16px; width:min(420px,90%); padding:1.4rem 1.3rem 1.5rem; box-shadow:0 8px 28px -8px rgba(0,0,0,.7); display:flex; flex-direction:column; gap:1rem; font-size:.72rem; line-height:1.35; }
.info-content h2 { margin:0; font-size:.9rem; letter-spacing:.08em; text-transform:uppercase; font-weight:650; color:#ffb347; }
.info-content li strong { color:#e6e9ee; }
.modal-close { align-self:flex-end; background:#19222c; border:1px solid #2c3845; color:#e1e5e9; padding:.45rem .75rem .5rem; border-radius:8px; font-size:.6rem; letter-spacing:.08em; text-transform:uppercase; font-weight:600; cursor:pointer; }
.modal-close:hover { background:#1f2a35; }
html.high-contrast body { background:#000 !important; color:#fff; }
html.high-contrast .cover, html.high-contrast .metric, html.high-contrast .chart, html.high-contrast .table-wrapper { border-color:#fff !important; }
html.high-contrast .chip.active { background:#fff; color:#000; }
.cover .steps { display:grid; gap:.55rem; font-size:.85rem; max-width:760px; margin:0 0 1.3rem; padding:1rem 1.1rem 1.05rem; background:#161d25; border:1px solid #24303d; border-radius:12px; }
.cover .steps div { line-height:1.3; }
.cover .steps strong { color:#ffb347; }
.cover .tips { font-size:.75rem; opacity:.75; max-width:760px; margin-bottom:1.4rem; }
/* Cover-specific: use upload CTA text token for the hero upload button */
.cover .primary-cta .kw {
  color: var(--upload-cta-text);
  text-shadow: var(--upload-cta-text-shadow);
}
.orb-icon { display:inline-block; filter:drop-shadow(0 0 4px rgba(255,179,71,.45)); transition:transform .5s ease, filter .4s; }
.upload-btn:hover .orb-icon { transform:rotate(8deg) scale(1.05); filter:drop-shadow(0 0 6px rgba(255,179,71,.7)); }
.upload-btn .orb-icon { margin-right:.3rem; }

/* Light theme & new enhancement components */

.primary-actions { display:flex; gap:.5rem; flex-wrap:wrap; margin-top:.4rem; }
.primary-actions button { background:#19222c; border:1px solid #2c3845; color:#d5dae0; padding:.5rem .85rem .55rem; border-radius:9px; font-size:.62rem; letter-spacing:.07em; font-weight:600; text-transform:uppercase; cursor:pointer; }
.primary-actions button:hover { background:#1f2a35; }

/* Expanded cover value content */
.value-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); gap:.5rem .6rem; margin:.3rem 0 .7rem; }
.value-grid.merged { margin:.4rem 0 .7rem; }
.value-grid .val-item { background:#161d25; border:1px solid #24303d; padding:.5rem .6rem .55rem; border-radius:12px; display:flex; flex-direction:column; gap:.25rem; font-size:.63rem; letter-spacing:.02em; line-height:1.3; position:relative; box-shadow:0 2px 4px rgba(0,0,0,.35); }
.value-grid .val-item strong { font-size:.64rem; letter-spacing:.09em; text-transform:uppercase; font-weight:650; color:#ffb347; }
@media (max-width:720px){ .value-grid { grid-template-columns:repeat(auto-fit,minmax(140px,1fr)); } }
.cover-sub-sections { display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:.6rem .8rem; margin:.3rem 0 .8rem; }
.cover-sub-sections.merged-panels { margin:.2rem 0 .8rem; }
.cover-sub-sections h2 { margin:0 0 .4rem; font-size:.68rem; letter-spacing:.12em; text-transform:uppercase; font-weight:700; color:#ffe6a6; }
.use-cases ul, .trust-badges ul { list-style:disc; margin:.1rem 0 0 1.1rem; padding:0; display:grid; gap:.25rem; font-size:.58rem; line-height:1.3; }
.use-cases, .trust-badges { background: var(--panel-bg, #151c24); border: 1px solid var(--panel-border, #24313d); border-radius: 12px; padding: .6rem .75rem .65rem; box-shadow: 0 6px 20px -12px rgba(0,0,0,.55); position:relative; }
.use-cases:before, .trust-badges:before { content:""; position:absolute; inset:0; border-radius:inherit; background:radial-gradient(circle at 85% 18%, rgba(255,179,71,.08), transparent 60%); pointer-events:none; }
.trust-badges li { position:relative; }
@media (max-width:900px){ .cover-sub-sections { grid-template-columns:1fr; } }

/* AI consent modal */
.ai-consent-layer .themed-modal-content.ai-consent-modal { background:var(--surface-2); border:1px solid var(--surface-2-border); border-radius:18px; width:min(480px,92%); padding:1.5rem 1.4rem 1.6rem; box-shadow:0 10px 32px -10px rgba(0,0,0,.8), 0 4px 12px -4px rgba(0,0,0,.6), 0 0 0 1px rgba(255,255,255,0.05) inset; font-size:.74rem; display:flex; flex-direction:column; gap:1rem; }
.ai-consent-modal h2 { margin:0; font-size:.95rem; letter-spacing:.08em; text-transform:uppercase; font-weight:650; background:linear-gradient(90deg,#ffb347,#ffd86b); -webkit-background-clip:text; background-clip:text; color:transparent; }
.ai-consent-body p { margin:.1rem 0 .4rem; line-height:1.4; }
.ai-consent-points { margin:.15rem 0 .6rem 1.1rem; padding:0; display:grid; gap:.35rem; }
.ai-consent-points li { line-height:1.25; }
.ai-consent-points .kw-local { color:#5ad67d; font-weight:600; }
.ai-consent-points .kw-private { color:#ffb347; font-weight:600; }
.ai-consent-points .kw-offline { color:#9d7ef7; font-weight:600; }
.ai-consent-modal .remember-choice { font-size:.62rem; letter-spacing:.06em; display:flex; align-items:center; gap:.4rem; font-weight:600; }
.ai-consent-modal .remember-choice input { width:14px; height:14px; accent-color:#ffb347; }
.ai-consent-modal .themed-actions { display:flex; justify-content:flex-end; gap:.6rem; }
.ai-consent-modal .btn-cancel, .ai-consent-modal .btn-danger { background:#19222c; border:1px solid #2c3845; color:#d5dae0; padding:.55rem .85rem .6rem; border-radius:8px; font-size:.6rem; letter-spacing:.07em; text-transform:uppercase; font-weight:600; cursor:pointer; }
.ai-consent-modal .btn-danger { background:#352226; border-color:#4a2f33; color:#ffbfb7; }
.ai-consent-modal .btn-primary { background:linear-gradient(140deg,#163252 0%,#1e3f63 60%,#163252 100%); border:1px solid #275278; color:#d2e9fa; box-shadow:0 0 0 1px rgba(90,150,214,.15) inset, 0 2px 6px -2px rgba(0,0,0,.65), 0 0 0 0 rgba(64,140,255,0); position:relative; transition:background .4s, box-shadow .5s, border-color .4s, color .4s; }
.ai-consent-modal .btn-primary:hover { background:linear-gradient(140deg,#1c4064 0%,#25537a 60%,#1c4064 100%); border-color:#2f6b9d; color:#e8f5ff; box-shadow:0 0 0 1px rgba(64,140,255,.35) inset, 0 4px 12px -4px rgba(0,0,0,.7), 0 0 14px -4px rgba(64,140,255,.55); }
.ai-consent-modal .btn-primary:active { background:linear-gradient(140deg,#173653 0%,#1d486a 60%,#173653 100%); box-shadow:0 0 0 1px rgba(64,140,255,.4) inset, 0 2px 6px -3px rgba(0,0,0,.65); }
.ai-consent-modal .btn-primary:focus-visible { outline:2px solid #4090ff; outline-offset:2px; }
.ai-consent-modal .btn-cancel:hover { background:#1f2a35; }
.ai-consent-modal .btn-danger:hover { background:#40292d; }
.ai-consent-modal .btn-cancel:focus-visible, .ai-consent-modal .btn-danger:focus-visible { outline:2px solid #ffb347; outline-offset:2px; }
@media (prefers-reduced-motion: reduce){ .ai-consent-modal { transition:none; } .btn { transition:none; } .metric { transition:none; } .chip { transition:none; } .clear-filters { transition:none; } .chart { transition:none; } }
.more-actions { display:flex; flex-wrap:wrap; gap:.45rem; margin:.55rem 0 .2rem; }
.more-actions button { background:var(--surface-2); border:1px solid var(--surface-2-border); color:var(--text-strong); padding:.4rem .7rem .45rem; border-radius:8px; font-size:.55rem; letter-spacing:.07em; font-weight:600; text-transform:uppercase; cursor:pointer; box-shadow:0 1px 2px rgba(0,0,0,0.3); transition:background-color 200ms ease, transform 150ms ease, box-shadow 150ms ease; }
.more-actions button:hover { background:var(--surface-3); transform:translateY(-1px); box-shadow:0 4px 10px rgba(0,0,0,0.5); }
.cover { position:relative; }

.cta-row { display:flex; gap:.7rem; align-items:center; flex-wrap:wrap; margin:.2rem 0 .4rem; }
.primary-cta { background:linear-gradient(135deg,#ffb347,#ffcb74); color:#111; font-weight:650; letter-spacing:.07em; text-transform:uppercase; padding:.85rem 1.2rem .9rem; border-radius:14px; font-size:.8rem; border:1px solid #ffd27f; cursor:pointer; display:inline-flex; align-items:center; gap:.55rem; position:relative; box-shadow:0 6px 14px -6px rgba(0,0,0,.6), 0 1px 0 rgba(255,255,255,.25) inset; }
.primary-cta:hover { filter:brightness(1.05); }
.primary-cta:active { transform:translateY(1px); }
.primary-cta:focus-visible { outline:3px solid #ffe6a6; outline-offset:3px; }
.secondary-cta { background:#19222c; color:#d8dde2; border:1px solid #2c3845; padding:.75rem 1rem .8rem; border-radius:12px; font-size:.68rem; letter-spacing:.07em; font-weight:600; text-transform:uppercase; cursor:pointer; box-shadow:0 4px 10px -4px rgba(0,0,0,.55); }
.secondary-cta:hover { background:#1f2a35; }
.drop-hint { font-size:.62rem; letter-spacing:.08em; text-transform:uppercase; opacity:.55; margin:-.2rem 0 .55rem; font-weight:600; }
.cta-note { font-size:.64rem; letter-spacing:.06em; text-transform:uppercase; opacity:.65; margin:.1rem 0 .35rem; font-weight:600; }

/* Themed confirmation modal */
.themed-modal { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:2200; }
.themed-backdrop { position:absolute; inset:0; background:rgba(0,0,0,.6); backdrop-filter:blur(12px) saturate(1.2); animation:fadeIn .25s ease; }
.themed-modal-content { position:relative; z-index:2; width:min(440px,92%); background:#161d25; border:1px solid #24303d; border-radius:18px; padding:1.4rem 1.35rem 1.5rem; box-shadow:0 14px 36px -10px rgba(0,0,0,.8), 0 2px 6px -2px rgba(0,0,0,.55); display:flex; flex-direction:column; gap:1rem; font-size:.75rem; line-height:1.35; animation:popIn .35s cubic-bezier(.4,0,.2,1); }
.themed-modal-content h2 { margin:0; font-size:.95rem; letter-spacing:.08em; text-transform:uppercase; font-weight:650; background:linear-gradient(90deg,#ffb347,#ffd86b); -webkit-background-clip:text; background-clip:text; color:transparent; }
.themed-modal-content p { margin:0; color:#b5c0c9; font-size:.68rem; line-height:1.4; }
.themed-actions { display:flex; justify-content:flex-end; gap:.6rem; margin-top:.2rem; }
.themed-actions button { font-size:.6rem; letter-spacing:.08em; text-transform:uppercase; font-weight:600; padding:.55rem .85rem .6rem; border-radius:10px; cursor:pointer; border:1px solid; }
.themed-actions .btn-cancel { background:#19222c; color:#d5dae0; border-color:#2c3845; }
.themed-actions .btn-cancel:hover { background:#1f2a35; }
.themed-actions .btn-danger { background:linear-gradient(135deg,#472226,#5c2b2f); color:#ffb9b9; border-color:#5a3134; position:relative; }
.themed-actions .btn-danger:before { content:""; position:absolute; inset:0; border-radius:inherit; padding:1px; background:linear-gradient(120deg,rgba(255,107,107,.9),rgba(255,107,107,0) 55%, rgba(255,179,71,.55)); -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); -webkit-mask-composite:xor; mask-composite:exclude; opacity:.6; pointer-events:none; }
.themed-actions .btn-danger:hover { filter:brightness(1.08); }
.themed-actions .btn-danger:active { transform:translateY(1px); }
.themed-actions .btn-danger:focus-visible, .themed-actions .btn-cancel:focus-visible { outline:2px solid #ffb347; outline-offset:2px; }

/* Runtime error banner (used by runtime probe) */
.runtime-error-banner {
  position: fixed;
  z-index: 99999;
  top: 0; left: 0; right: 0;
  font: 12px/1.4 system-ui, monospace;
  background: var(--error-bg);
  color: var(--error-color);
  padding: 8px 12px;
  border-bottom: 2px solid var(--error-border);
  box-shadow: 0 4px 12px -4px rgba(0,0,0,.6);
  white-space: pre-wrap;
  max-height: 40vh;
  overflow: auto;
}

/* Standardized small action button used in error UI */
.themed-small-btn {
  background: var(--panel-bg);
  border: 1px solid var(--panel-border);
  color: var(--text-strong);
  padding: .48rem .85rem;
  border-radius: 8px;
  font-size: .6rem;
  font-weight: 600;
  letter-spacing: .07em;
  text-transform: uppercase;
  cursor: pointer;
}
.themed-small-btn.secondary {
  background: linear-gradient(135deg,#472226,#5c2b2f);
  border-color: #4a2f33;
  color: var(--accent-warm);
}
@keyframes popIn { 0% { opacity:0; transform:translateY(14px) scale(.95);} 60% { opacity:1; transform:translateY(-2px) scale(1.01);} 100% { opacity:1; transform:translateY(0) scale(1);} }
@keyframes fadeIn { from { opacity:0;} to { opacity:1;} }
@media (prefers-reduced-motion: reduce){ .themed-modal-content { animation:none; } .themed-backdrop { animation:none; } }

/* Defensive small-screen rules to prevent overflow/overlap and force stacking at <=640px */
@media (max-width: 640px) {
  :root { --gutter-sm: 8px; }

  /* Ensure primary structural containers always fit viewport */
  .app-shell, main, header, footer, .cover, .card, .panel, .table-wrapper {
    box-sizing: border-box;
    width: 100% !important;
    max-width: 100% !important;
    padding-left: var(--gutter-sm) !important;
    padding-right: var(--gutter-sm) !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    position: relative !important;
    overflow: visible !important;
    clear: both !important;
  }

  /* Header: stack on mobile */
  .dbz-header { 
    flex-direction:column !important; 
    align-items:flex-start !important; 
    gap:.75rem !important; 
    padding:.75rem 0 .75rem !important; 
  }
  .dbz-header .logo-block { 
    width:100% !important;
  }
  .dbz-header .header-actions { 
    width:100% !important; 
    justify-content:flex-start !important; 
  }

  /* Make mascot and title scale and wrap safely */
  .mascot-icon { width:32px !important; height:32px !important; }
  .dbz-header .logo { font-size:1.05rem !important; white-space:normal !important; overflow-wrap:anywhere !important; }
  .dbz-header .subtitle { font-size:0.78rem !important; }

  /* Buttons & CTAs: full-width, shrinkable, and with sane min-width */
  .primary-cta, .secondary-cta, .upload-btn, .download-btn, .btn {
    width: 100% !important;
    min-width: 0 !important;
    flex: 0 1 auto !important;
    box-sizing: border-box !important;
  }

  /* Upload zone should not exceed viewport and should allow internal scrolling if needed */

  /* Rows that contain many controls must wrap */
  .filters-secondary-row, .metrics, .mix-bar, .download-actions, .primary-actions {
    display:flex !important;
    flex-wrap:wrap !important;
    gap:8px !important;
    align-items:stretch !important;
  }
  .filters-secondary-row > *, .metrics > *, .download-actions > *, .primary-actions > * { flex: 1 1 100% !important; min-width: 0 !important; }

  /* Charts: stack vertically and allow inner scroll rather than overflow the page */
  .charts-row, .charts-row .chart { flex-direction:column !important; flex:1 1 100% !important; width:100% !important; min-width:0 !important; }
  .chart .plot-inner, .plotly-graph { max-width:100% !important; width:100% !important; overflow:auto !important; -webkit-overflow-scrolling:touch !important; }

  /* Tables: allow horizontal scroll inside their container but keep table wrapper constrained */
  .table-wrapper { overflow:hidden !important; }
  table, .txn-table { display:block !important; width:100% !important; overflow:auto !important; -webkit-overflow-scrolling:touch !important; }
  .txn-table td.desc { white-space:normal !important; }

  /* Popovers and dropdowns: center and constrain to viewport width to avoid clipping/overlap */
  .popover, .tooltip, .consistency-popover, .consistency-popover:before {
    position: absolute !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    width: calc(100% - (var(--gutter-sm) * 2)) !important;
    max-width: 100% !important;
    margin: 0 auto !important;
    z-index: 1200 !important;
  }

  /* Ensure focusable popovers can rise above other content */
  .popover[aria-hidden="false"], .consistency-popover[aria-hidden="false"], .date-pop, .themed-modal-content { z-index: 9999 !important; position: fixed !important; left: 50% !important; top: 50% !important; transform: translate(-50%,-50%) !important; width: calc(100% - 32px) !important; max-width: 560px !important; }

  /* Footer: stack and center */
  .site-footer { flex-direction:column !important; align-items:center !important; gap:8px !important; padding:12px !important; text-align:center !important; }

  /* Reduce spacing & padding for compactness */
  .card, .panel, .filters-advanced, .upload-panel, .categorize-cluster { padding:8px !important; margin-bottom:10px !important; }

  /* Last-resort: prevent any element from exceeding the viewport width */
  html, body, #root, * { max-width: 100vw !important; box-sizing: border-box !important; }
}

/* Mobile / small-screen improvements */
@media (max-width: 640px) {
  :root { --container-pad-x: .6rem; --container-pad-y: .45rem; }
  .app-shell { padding: 0 0.8rem 3rem; max-width:100%; }

  /* Header: stack and reduce spacing */
  .dbz-header { padding:.7rem .6rem .6rem; }
  .dbz-header .logo-block { gap:.4rem; align-items:center; }
  .dbz-header .header-actions { position:static; top:auto; right:auto; margin-top:.35rem; display:flex; justify-content:flex-end; }

  /* Cover: stack columns and reduce hero size */
  .cover { padding:1.2rem 1rem 1.4rem; border-radius:12px; }
  .cover h1.cover-global-title { font-size:1.45rem; text-align:left; max-width:100%; }
  .global-tagline { text-align:left; font-size:0.95rem; }
  .cover-grid { grid-template-columns:1fr; gap:1rem; }
  .cover-left, .cover-right { padding:0; }
  .cover-left .cta-row { margin-top:.4rem; }

  /* CTAs & upload: full width, stacked */
  .cta-row { flex-direction:column; align-items:stretch; gap:.6rem; }
  .upload-panel { flex-direction:column; align-items:stretch; gap:.6rem; }
  .upload-btn, .primary-cta, .secondary-cta, .download-btn { width:100%; justify-content:center; }

  /* Cards and compact text */
  .recent-card, .value-grid .val-item { font-size:0. Ninerem; }
  .recent-card, .value-grid .val-item { padding:.6rem .7rem; }

  /* Footer: stack and left-align */
  .site-footer { flex-direction:column; align-items:center; gap:.5rem; padding-top:.8rem; font-size:0.82rem; text-align:center; }
  .site-footer .brand { font-size:0.96rem; }

  /* Smaller mascot and charts flow */
  .mascot-icon { width:28px; height:28px; }
  .charts-row.four-charts.unified .chart { flex:1 1 100%; width:100%; }

  /* Filters and inputs: reduce paddings to avoid overflow */
  .filters .search-composite input.filter-text { padding-right:1rem; }
  .primary-actions { flex-direction:column; gap:.5rem; }

  /* Accordion / instruction bodies more compact */
  .instruction-accordion .ia-item .ia-body { padding:.65rem .85rem; }

  /* Tables / wrappers */
  .table-wrapper { padding:.6rem .7rem; }
}

/* New AI pill toggle */
.ai-pill-toggle { position:relative; display:inline-flex; align-items:center; gap:.45rem; background:#182029; border:1px solid #273640; color:#c5cdd2; padding:.48rem .85rem .52rem; border-radius:999px; font-size:.58rem; font-weight:650; text-transform:uppercase; letter-spacing:.07em; cursor:pointer; line-height:1; transition:background .35s, border-color .35s, color .35s, box-shadow .4s; }
.ai-pill-toggle .dot { width:10px; height:10px; border-radius:50%; background:radial-gradient(circle at 35% 35%, #7a8995, #55616b); box-shadow:0 0 0 0 rgba(90,214,125,0); transition:background .4s, transform .4s, box-shadow 1.2s; }
.ai-pill-toggle:hover { background:#1d2f3a; border-color:#314655; }
.ai-pill-toggle:focus-visible { outline:2px solid #ffb347; outline-offset:2px; }
.ai-pill-toggle.active { background:linear-gradient(135deg,#253027 0%,#2d3a31 60%); border-color:#355041; color:#f0f5f6; box-shadow:0 4px 12px -5px rgba(0,0,0,.55), 0 0 0 1px rgba(255,255,255,.05) inset; }
.ai-pill-toggle.active .dot { background:radial-gradient(circle at 35% 35%, #5ad67d, #1ea154); transform:scale(1.3); box-shadow:0 0 0 0 rgba(90,214,125,.55); animation:aiPulse 2.8s ease-in-out infinite; }
@keyframes aiPulse { 0% { box-shadow:0 0 0 0 rgba(90,214,125,.55);} 60% { box-shadow:0 0 0 7px rgba(90,214,125,0);} 100% { box-shadow:0 0 0 0 rgba(90,214,125,0);} }
@media (prefers-reduced-motion: reduce){ .ai-pill-toggle.active .dot { animation:none; } }

/* Accessibility: focus + keyboard */
.benefits-heading { margin:0 0 .9rem; font-size:1rem; letter-spacing:.1em; text-transform:uppercase; font-weight:650; background:linear-gradient(90deg,#ffe6a6,#ffb347 70%); -webkit-background-clip:text; background-clip:text; color:transparent; }
.sample-preview { background: var(--panel-bg, #161d25); border:1px solid var(--panel-border, #24303d); border-radius:12px; margin:.4rem 0 .5rem; padding:.55rem .65rem; display:flex; flex-direction:column; gap:.4rem; box-shadow:0 8px 20px -12px rgba(0,0,0,.55); }
.sample-preview .sp-head { font-size:.62rem; letter-spacing:.11em; text-transform:uppercase; font-weight:700; color:var(--accent, #ffb347); }
.sample-preview .sp-body { display:flex; flex-wrap:wrap; gap:.8rem 1.2rem; align-items:center; }
.sample-preview .sp-spark { width:160px; height:42px; flex:0 0 auto; filter:drop-shadow(0 6px 18px rgba(0,0,0,.5)); border-radius:8px; overflow:hidden; }
.sp-spark .sp-pulse { opacity:.9; animation:spPulseScale 3.2s cubic-bezier(.4,0,.2,1) infinite; filter:drop-shadow(0 0 4px rgba(26,169,155,.55)); }
.dark .sp-spark .sp-pulse { opacity:.85; }
@keyframes spPulseScale { 0% { transform:scale(.55); opacity:.05; } 12% { transform:scale(.9); opacity:.95; } 50% { transform:scale(.65); opacity:.45; } 100% { transform:scale(.55); opacity:.05; } }
.sample-preview .sp-metrics { display:flex; gap:1.1rem; flex-wrap:wrap; font-size:.58rem; }
.sample-preview .sp-metrics div { display:flex; flex-direction:column; gap:.2rem; }
.sample-preview .sp-metrics .lbl { font-size:.5rem; letter-spacing:.09em; text-transform:uppercase; font-weight:600; opacity:.55; }
.sample-preview .sp-metrics strong { font-size:.7rem; font-weight:600; color:var(--text-strong); }
.sample-preview .sp-foot { font-size:.52rem; line-height:1.25; opacity:.55; }
.settings-btn { background:#19222c; border:1px solid #2c3845; color:#d5dae0; padding:.5rem .75rem .55rem; border-radius:8px; font-size:.6rem; letter-spacing:.07em; font-weight:600; text-transform:uppercase; cursor:pointer; }
.settings-btn:hover { background:#1f2a35; }
.settings-panel { background:#161d25; border:1px solid #24303d; border-radius:14px; padding:.75rem .85rem .85rem; margin:.6rem 0 .4rem; display:flex; flex-direction:column; gap:.6rem; }
.settings-panel .setting-row { display:flex; flex-wrap:wrap; gap:.5rem; }
/* Unified settings buttons styling (match app theme) */
.settings-panel button { position:relative; background:linear-gradient(135deg,#19222c 0%,#202b37 70%); border:1px solid #2c3b4a; color:#d9dee3; padding:.55rem .85rem .6rem; border-radius:10px; font-size:.58rem; letter-spacing:.07em; font-weight:600; text-transform:uppercase; cursor:pointer; box-shadow:0 3px 8px -4px rgba(0,0,0,.55), 0 1px 0 rgba(255,255,255,.04) inset; transition:background .25s, box-shadow .25s, transform .2s, border-color .25s, color .25s; }
.settings-panel button:before { content:""; position:absolute; inset:0; border-radius:inherit; padding:1px; background:linear-gradient(120deg,rgba(255,179,71,.55),rgba(255,179,71,0) 45%, rgba(90,214,125,.35)); -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); -webkit-mask-composite:xor; mask-composite:exclude; opacity:.45; pointer-events:none; transition:opacity .35s; }
.settings-panel button:hover { background:linear-gradient(135deg,#1f2a35 0%,#273544 70%); box-shadow:0 5px 14px -6px rgba(0,0,0,.65), 0 1px 0 rgba(255,255,255,.05) inset; }
.settings-panel button:active { transform:translateY(1px); background:linear-gradient(135deg,#1a242d 0%,#22303d 70%); }
.settings-panel button:focus-visible { outline:none; box-shadow:0 0 0 2px #0f1115, 0 0 0 4px #ffb347; }
/* Variant accents */
.settings-panel .contrast-btn { background:linear-gradient(135deg,#25202f,#2e2740 70%); border-color:#3a2f4d; }
.settings-panel .contrast-btn:hover { background:linear-gradient(135deg,#2e2740,#382f4f 70%); }
.settings-panel .date-btn { background:linear-gradient(135deg,#262739,#2f3146 70%); border-color:#353650; }
.settings-panel .date-btn:hover { background:linear-gradient(135deg,#2f3146,#383a54 70%); }
.settings-panel .clear-all-btn { background:linear-gradient(135deg,#352226,#40292d 70%); border-color:#4a2f33; color:#f1d4d6; }
.settings-panel .clear-all-btn:hover { background:linear-gradient(135deg,#40292d,#4a3136 70%); }
html.high-contrast .settings-panel button { background:#000 !important; color:#fff !important; border-color:#fff !important; box-shadow:none; }
html.high-contrast .settings-panel button:before { display:none; }
.drag-overlay { position:absolute; inset:0; background:rgba(15,17,21,.72); backdrop-filter:blur(3px); display:flex; align-items:center; justify-content:center; z-index:25; border:2px dashed #ffb347; border-radius:18px; }
.drag-overlay-inner { font-size:1rem; letter-spacing:.06em; text-transform:uppercase; font-weight:700; background:#11181f; padding:1.2rem 1.6rem 1.3rem; border:1px solid #27323d; border-radius:16px; color:#ffb347; box-shadow:0 6px 18px -6px rgba(0,0,0,.65); }
.info-content.whatsnew { max-width:520px; }
.info-content.whatsnew .changelog { list-style:disc; margin:.2rem 0 .2rem 1.1rem; padding:0; display:grid; gap:.4rem; }
.info-content.whatsnew .changelog li { font-size:.62rem; line-height:1.3; }

/* Uniform column sizing: all even, Description wider */
th.col-description, td.desc { width:240px; max-width:240px; }
th.col-date, td.col-date { width:100px; max-width:100px; }
th.col-category, td.col-category { width:120px; max-width:120px; }
th.col-amount, td.col-amount { width:120px; max-width:120px; text-align:right; }
th.col-balance, td.col-balance { width:120px; max-width:120px; text-align:right; }
th.col-type, td.col-type { width:120px; max-width:120px; }
th.col-source, td.col-source { width:120px; max-width:120px; }
th.col-category, th.col-amount, th.col-balance, th.col-type, th.col-source,
td.col-category, td.col-amount, td.col-balance, td.col-type, td.col-source { white-space:nowrap; }

/* Themed category select to match global controls */
.col-category .category-select {
  width:100%;
  background:var(--btn-bg, #19222c);
  color:var(--text-base, #e6e9ee);
  border:1px solid var(--btn-border, #2c3845);
  padding:3px 8px;
  height:26px; /* tighter to sit nicely inside the 32px row */
  min-width:170px;
  border-radius:8px;
  font-size:0.9rem;
  line-height:1.1;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
  display:inline-block; vertical-align:middle;
}
.col-category .category-select:focus-visible {
  outline:none;
  /* Shorter, subtler bubble to match row density */
  box-shadow: 0 1px 6px rgba(0,0,0,0.45), 0 0 0 2px rgba(15,17,21,0.85), 0 0 0 4px rgba(255,179,71,0.08);
  border-color: rgba(255,179,71,0.18);
}
/* When user overrides a category, surface text in theme yellow */
.col-category.category-override,
.col-category .category-select.override {
  color: var(--accent, #ffb347) !important;
  font-weight:600;
}

/* AI-highlighted categories */
.col-category.category-ai,
.col-category .category-select.ai {
  color: var(--ai-accent) !important;
  font-weight: 650;
}
.col-category.category-ai .category-select.ai {
  border-color: var(--ai-accent-border);
  box-shadow: 0 0 0 1px var(--ai-accent-soft), 0 0 10px rgba(72,243,255,0.12);
}
tr.ai-row td.col-category {
  background: linear-gradient(90deg, var(--ai-accent-soft), rgba(72,243,255,0));
}
.ai-change-pill {
  display: inline-flex;
  align-items: center;
  height: 18px;
  padding: 0 6px;
  border-radius: 999px;
  font-size: 0.58rem;
  font-weight: 700;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: #0b1a1d;
  background: var(--ai-accent);
  box-shadow: 0 1px 6px rgba(0,0,0,0.35);
}

/* Remove native arrow, add custom caret and subtle styling for the dropdown control */
.col-category .category-select {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  padding-right: 34px; /* space for custom caret */
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 10 6'><path d='M1 1.5 L5 4.5 L9 1.5' stroke='%239fb1bd' stroke-width='1.4' stroke-linecap='round' stroke-linejoin='round' fill='none'/></svg>");
  background-repeat: no-repeat;
  background-position: right 8px center;
  background-size: 12px 8px;
  transition: box-shadow .14s ease, border-color .12s ease, background-color .12s ease;
}
.col-category .category-select::-ms-expand { display:none; }

/* Make the dropdown list (options) adopt a dark background where supported */
.col-category .category-select option {
  background: var(--btn-bg, #19222c);
  color: var(--text-base, #e6e9ee);
}

/* Subtle hover/focus states to make popup less 'loud' */
.col-category .category-select:hover {
  border-color: rgba(255,255,255,0.04);
}
.col-category .category-select:active, .col-category .category-select:focus {
  box-shadow: 0 1px 6px rgba(0,0,0,0.48);
}



/* Enlarged categorize & AI toggle enhancements */
.categorize-btn.inline.large { font-size:.85rem; font-weight:600; letter-spacing:.5px; padding:.55rem .9rem .6rem; border:1px solid var(--accent-border, #2b6c9e); box-shadow:0 0 0 1px rgba(255,255,255,0.05),0 2px 4px -1px rgba(0,0,0,.5); }
.categorize-btn.inline.large.needs-action { animation:pulseSoft 2.2s ease-in-out infinite; }
@keyframes pulseSoft { 0%,100% { box-shadow:0 0 0 1px rgba(255,255,255,0.05), 0 2px 4px -1px rgba(0,0,0,.5), 0 0 0 0 rgba(0,170,255,.35); } 50% { box-shadow:0 0 0 1px rgba(255,255,255,0.05), 0 2px 6px -1px rgba(0,0,0,.55), 0 0 0 6px rgba(0,170,255,0); } }

/* Revamped Categorize button */
.categorize-btn.revamp-cat { position:relative; overflow:hidden; border-radius:12px; padding:.9rem 1.15rem 1rem; background:#15212b; border:1px solid #264356; font-size:.78rem; font-weight:650; letter-spacing:.08em; text-transform:uppercase; color:#eef4f7; display:inline-flex; align-items:center; justify-content:center; gap:.55rem; isolation:isolate; }
.categorize-btn.revamp-cat.is-uncategorize { background:#27171a; border-color:#5a2e36; }
.categorize-btn.revamp-cat.is-uncategorize .cat-btn-bg { background:radial-gradient(circle at 30% 35%, rgba(255,107,107,.45), rgba(255,107,107,0) 65%), linear-gradient(135deg,#2a1a1d,#1d1315 55%,#2a1a1d); }
.categorize-btn.revamp-cat.is-uncategorize .cat-btn-glow { background:conic-gradient(from 0deg, rgba(255,107,107,.85), rgba(255,179,71,.6), rgba(255,107,107,.85)); opacity:.45; }
.categorize-btn.revamp-cat.flash-once { animation:catFlashSuccess 1.2s ease-in-out 1; }
@keyframes catFlashSuccess { 0% { box-shadow:0 0 0 0 rgba(90,214,125,.0),0 0 0 0 rgba(255,179,71,0); } 30% { box-shadow:0 0 0 2px rgba(90,214,125,.5),0 0 12px 4px rgba(255,179,71,.35); } 70% { box-shadow:0 0 0 2px rgba(90,214,125,.25),0 0 6px 2px rgba(255,179,71,.15); } 100% { box-shadow:0 0 0 0 rgba(90,214,125,0),0 0 0 0 rgba(255,179,71,0); } }
.categorize-btn.revamp-cat .cat-btn-bg { position:absolute; inset:0; background:radial-gradient(circle at 30% 35%, rgba(255,179,71,.4), rgba(255,179,71,0) 65%), linear-gradient(135deg,#173040,#12212d 55%,#173040); opacity:.9; }
.categorize-btn.revamp-cat .cat-btn-glow { position:absolute; inset:-1px; padding:1px; border-radius:inherit; background:conic-gradient(from 0deg, rgba(255,179,71,.8), rgba(51,209,192,.5), rgba(255,179,71,.8)); -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); -webkit-mask-composite:xor; mask-composite:exclude; opacity:.4; transition:opacity .5s; }
.categorize-btn.revamp-cat:hover .cat-btn-glow { opacity:.8; }
.categorize-btn.revamp-cat:focus-visible { outline:none; box-shadow:0 0 0 3px #0f1115, 0 0 0 6px #ffb347; }
.categorize-btn.revamp-cat .cat-btn-content { position:relative; z-index:2; display:inline-flex; align-items:center; gap:.55rem; }
.categorize-btn.revamp-cat .cat-label { background:linear-gradient(90deg,#ffe0a8,#ffb347 55%,#ffd27f); -webkit-background-clip:text; background-clip:text; color:transparent; text-shadow:0 0 6px rgba(255,179,71,.45); }
.categorize-btn.revamp-cat.needs-action { animation:revampGlow 2.8s ease-in-out infinite; }


/* Toast Notifications */
.toast-container {
  position: fixed;
  bottom: 1.2rem;
  right: 1.2rem;
  z-index: 10000;
  display: flex;
  flex-direction: column;
  gap: .6rem;
  max-width: 400px;
  pointer-events: none;
}

.toast-item {
  display: flex;
  align-items: flex-start;
  gap: .8rem;
  padding: 1rem 1.2rem;
  border-radius: 10px;
  box-shadow: 0 8px 24px -8px rgba(0,0,0,.6), 0 4px 8px -2px rgba(0,0,0,.4);
  animation: toastSlideIn .28s cubic-bezier(.4,0,.2,1);
  pointer-events: auto;
  position: relative;
  border-left: 4px solid;
  border-left-color: inherit;
}

@keyframes toastSlideIn {
  from {
    opacity: 0;
    transform: translateX(120%) translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0) translateY(0);
  }
}


.toast-close {
  flex: 0 0 24px;
  background: none;
  border: none;
  padding: 0;
  font-size: 1.2rem;
  font-weight: 600;
  cursor: pointer;
  opacity: .7;
  transition: opacity .2s ease, transform .15s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  height: 24px;
}

.toast-close:hover {
  opacity: 1;
  transform: scale(1.1);
}

.toast-close:focus-visible {
  outline: 2px solid currentColor;
  outline-offset: 2px;
  border-radius: 3px;
}

@media (max-width: 640px) {
  .toast-container {
    bottom: .8rem;
    right: .8rem;
    left: .8rem;
    max-width: none;
  }

  .toast-item {
    padding: .85rem 1rem;
    gap: .6rem;
  }

}

@media (prefers-reduced-motion: reduce) {
  .toast-item {
    animation: none;
  }
  
  .toast-close {
    transition: none;
  }
}


/* ===== PHASE 2: MEDIUM PRIORITY ENHANCEMENTS ===== */

/* ===== PHASE 3: POLISH & ADVANCED FEATURES ===== */


@keyframes revampGlow { 0%,100% { filter:drop-shadow(0 0 0 rgba(255,179,71,0)); } 50% { filter:drop-shadow(0 0 10px rgba(255,179,71,.55)); } }
.categorize-btn.revamp-cat.is-loading .cat-label { opacity:0; }
.categorize-btn.revamp-cat.is-loading { cursor:progress; }
.categorize-btn.revamp-cat .cat-spinner { width:18px; height:18px; border:3px solid rgba(255,255,255,.15); border-top-color:#ffb347; border-radius:50%; animation:spin 1s linear infinite; }
@media (prefers-reduced-motion: reduce){ .categorize-btn.revamp-cat.needs-action { animation:none; } .categorize-btn.revamp-cat .cat-spinner { animation:none; } }
@media (prefers-reduced-motion: reduce){ .categorize-btn.inline.large.needs-action { animation:none; } }

/* ------------------------------------------------------------ */
/* Unified Button System (interactive vs static differentiation) */
/* ------------------------------------------------------------ */
:root {
  --btn-bg:#19222c;
  --btn-bg-alt:#1d2731;
  --btn-border:#2c3845;
  --btn-hover:#22303c;
  --btn-active:#19242d;
  --btn-radius:10px;
  --btn-focus-ring:0 0 0 2px #0f1115,0 0 0 4px #ffb347;
}

/* Base interactive surface (applies additive styling without clobbering existing custom gradients) */
button,
.primary-cta,
.secondary-cta,
.upload-btn,
.download-btn,
.clear-filters,
.col-toggle-btn,
.chip,
.categorize-btn.inline,
.categorize-btn.revamp-cat,
.ai-pill-toggle,
.dev-link,
.settings-panel button,
.primary-actions button,
.more-actions button,
.reset-btn {
  position:relative;
  cursor:pointer;
  font-family:inherit;
  -webkit-user-select:none;
  user-select:none;
  isolation:isolate; /* so pseudo elements layer cleanly */
}

/* Unify subtle inner highlight & outline for focusable interactive controls */
button:not(.plain)::before,
.primary-cta::before,
.secondary-cta::before,
.upload-btn::before,
.download-btn::before,
.clear-filters::before,
.col-toggle-btn::before,
.chip::before,
.categorize-btn.inline::before,
.categorize-btn.revamp-cat::before,
.ai-pill-toggle::before,
.dev-link::before,
.settings-panel button::before,
.primary-actions button::before,
.more-actions button::before,
.reset-btn::before {
  content:"";
  position:absolute; inset:0; border-radius:inherit; pointer-events:none;
  background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(255,255,255,0) 55%);
  mix-blend-mode:overlay; opacity:.28; transition:opacity .25s;
}

/* Hover / active emphasis (keeps existing color schemes) */
button:hover:not([disabled])::before,
.primary-cta:hover::before,
.secondary-cta:hover::before,
.upload-btn:hover::before,
.download-btn:hover::before,
.clear-filters:hover::before,
.col-toggle-btn:hover::before,
.chip:hover::before,
.categorize-btn.inline:hover::before,
.categorize-btn.revamp-cat:hover::before,
.ai-pill-toggle:hover::before,
.dev-link:hover::before,
.settings-panel button:hover::before,
.primary-actions button:hover::before,
.more-actions button:hover::before,
.reset-btn:hover::before { opacity:.45; }

/* Standard focus ring (do not override bespoke ones already defined) */
button:focus-visible:not(.primary-cta):not(.categorize-btn):not(.upload-btn),
.secondary-cta:focus-visible,
.download-btn:focus-visible,
.clear-filters:focus-visible,
.col-toggle-btn:focus-visible,
.chip:focus-visible,
.ai-pill-toggle:focus-visible,
.dev-link:focus-visible,
.reset-btn:focus-visible { box-shadow:var(--btn-focus-ring); outline:none; }

/* Harmonized secondary controls (keep primary CTAs bespoke) */
.filters-toggle,
.settings-btn,
.clear-filters,
.download-btn,
.reset-btn,
.btn {
  background: var(--btn-bg);
  border: 1px solid var(--btn-border);
  color: var(--text-base);
  border-radius: var(--btn-radius);
  box-shadow: 0 3px 8px -5px rgba(0,0,0,.6), 0 1px 0 rgba(255,255,255,.02) inset;
  text-transform: uppercase;
  letter-spacing: .07em;
  font-weight: 600;
}

.chip,
.col-toggle-btn,
.ai-pill-toggle {
  background: var(--btn-bg);
  border: 1px solid var(--btn-border);
  color: var(--text-base);
  box-shadow: 0 3px 8px -6px rgba(0,0,0,.6), 0 1px 0 rgba(255,255,255,.02) inset;
}

.filters-toggle:hover,
.settings-btn:hover,
.clear-filters:hover,
.download-btn:hover,
.reset-btn:hover,
.btn:hover,
.chip:hover,
.col-toggle-btn:hover,
.ai-pill-toggle:hover {
  background: var(--btn-hover);
  border-color: rgba(255,255,255,0.16);
}

.filters-toggle:active,
.settings-btn:active,
.clear-filters:active,
.download-btn:active,
.reset-btn:active,
.btn:active {
  background: var(--btn-active);
  transform: translateY(1px);
}

.chip.active {
  background: #ffb347;
  color: #111;
  border-color: #ffb347;
  box-shadow: 0 2px 6px rgba(255,179,71,0.4);
}

.col-toggle-btn.active {
  background: linear-gradient(135deg,#253027 0%,#2d3a31 60%);
  border-color: #355041;
  color: #e6ecef;
  box-shadow: 0 4px 12px -5px rgba(0,0,0,.55), 0 0 0 1px rgba(255,255,255,.04) inset;
}

.ai-pill-toggle.active {
  background: linear-gradient(135deg,#253027 0%,#2d3a31 60%);
  border-color: #355041;
  color: #f0f5f6;
  box-shadow: 0 4px 12px -5px rgba(0,0,0,.55), 0 0 0 1px rgba(255,255,255,.05) inset;
}

/* Static bubbles: deliberately flatter & non-interactive look */
.value-grid .val-item,
.use-cases,
.trust-badges,
.metric,
.sample-preview,
.dev-card,
.filters.consolidated,
.settings-panel,
.table-wrapper,
.charts-row .chart {
  box-shadow:0 1px 2px rgba(0,0,0,.4); /* softer */
  filter:saturate(.9);
}

/* Remove accidental pointer if any static containers inherit it */
.value-grid .val-item,
.use-cases,
.trust-badges,
.metric,
.sample-preview,
.dev-card,
.charts-row .chart { cursor:default; }

/* Chips & toggles alignment tweak (ensure consistent height) */
.chip, .col-toggle-btn, .ai-pill-toggle { line-height:1.05; }

/* Distinguish links inside dev-card from buttons */
.dev-card .dev-link { box-shadow:0 0 0 1px rgba(255,255,255,.05) inset; }
.dev-card .dev-link:hover { box-shadow:0 0 0 1px rgba(255,255,255,.15) inset; }

/* Themed compact dropdown button (used for inline help/info next to controls) */
.dropdown-btn { background:linear-gradient(135deg,#1d2b33 0%,#23323b 70%); border:1px solid #2f3a41; color:#d7dde2; padding:.38rem .6rem .42rem; border-radius:9px; font-size:.56rem; letter-spacing:.07em; font-weight:700; text-transform:uppercase; cursor:pointer; position:relative; line-height:1; box-shadow:0 3px 8px -4px rgba(0,0,0,.55), 0 1px 0 rgba(255,255,255,.04) inset; transition:background .25s, box-shadow .25s, transform .2s, border-color .25s, color .25s; }
.dropdown-btn.compact { padding:.32rem .5rem .36rem; font-size:.54rem; }
.dropdown-btn:hover { background:linear-gradient(135deg,#23323b 0%,#2b3c46 70%); box-shadow:0 5px 14px -6px rgba(0,0,0,.65), 0 1px 0 rgba(255,255,255,.05) inset; }
.dropdown-btn:active { transform:translateY(1px); }
.dropdown-btn:focus-visible { outline:none; box-shadow:0 0 0 2px #0f1115, 0 0 0 4px #ffb347; }
.dropdown-btn:after { content:"▾"; position:absolute; right:.38rem; top:50%; transform:translateY(-50%); font-size:.62rem; opacity:.85; }
.dropdown-btn.open:after { content:"▴"; }
.dropdown-btn.neutral { background:#19222c; border-color:#2c3845; }
.dropdown-btn.neutral:hover { background:#1f2a35; }
/* Align within categorize cluster primary row */
.categorize-cluster .dropdown-btn.compact { height:32px; display:inline-flex; align-items:center; padding:.18rem .6rem; }
.categorize-cluster .dropdown-btn.cat-help-btn {
  background:transparent;
  border:1px solid var(--surface-2-border);
  color:var(--text-muted);
  letter-spacing:.06em;
  box-shadow:none;
}
.categorize-cluster .dropdown-btn.cat-help-btn:hover {
  background:var(--surface-2);
  border-color:var(--surface-2-border);
}
.categorize-cluster .dropdown-btn.cat-help-btn:after {
  opacity:.6;
}

/* Upload warning alert */
.upload-warning { 
  margin-top: 0.75rem; 
  background: linear-gradient(135deg,#3b2f1a,#5a4217 60%,#7a5510);
  border: 1px solid #a76b18;
  color: #f6d9a4;
  padding: 0.75rem 1rem 0.75rem 1rem;
  border-radius: 8px;
  font-size: 0.85rem;
  position: relative;
  box-shadow: 0 2px 6px -2px rgba(0,0,0,0.6), 0 0 0 1px rgba(255,200,120,0.08) inset;
}
.upload-warning ul { list-style: disc; margin: 0 0 0.25rem 1.1rem; padding: 0; }
.upload-warning li { line-height: 1.25; margin: 0.2rem 0; }
.dismiss-upload-warning { 
  position: absolute; top: 4px; right: 6px; 
  background: rgba(0,0,0,0.25); 
  border: 1px solid rgba(255,255,255,0.15);
  color: #f6d9a4; 
  width: 22px; height: 22px; 
  border-radius: 6px; 
  cursor: pointer; 
  font-size: 0.9rem; 
  line-height: 1; 
  display: flex; align-items: center; justify-content: center; 
  transition: background .2s, color .2s, border-color .2s;
}
.dismiss-upload-warning:hover { background: #a76b18; color: #fff; border-color: #f6d9a4; }
.dismiss-upload-warning:focus { outline: 2px solid #f6d9a4; outline-offset: 2px; }
/* Supported note relocated from bottom info list */
.supported-note { font-size:.55rem; letter-spacing:.07em; text-transform:uppercase; opacity:.55; margin-top:.5rem; }
.supported-note .muted { text-transform:none; letter-spacing:normal; opacity:.7; }

/* Tagline moved beside upload (left column) when on cover */
.global-tagline.moved { margin:0 0 .9rem; text-align:left; font-size:.75rem; line-height:1.35; max-width:520px; opacity:.9; }
@media (max-width:620px){ .global-tagline.moved { font-size:.72rem; } }
@media (max-width:480px){ .global-tagline.moved { font-size:.68rem; } }
/* ===== AI STATUS INDICATOR ===== */
.ai-status-pill {
  margin-left: auto;
  display: inline-flex;
  align-items: center;
  gap: .35rem;
  padding: 0;
  border-radius: 0;
  font-size: .54rem;
  letter-spacing: .06em;
  text-transform: uppercase;
  font-weight: 600;
  border: 0;
  color: var(--text-muted);
  background: transparent;
  box-shadow: none;
}
.ai-status-pill:before {
  content:"";
  width:6px;
  height:6px;
  border-radius:999px;
  background: currentColor;
  box-shadow:0 0 0 1px rgba(0,0,0,0.15);
}

.ai-status-ok { color: #5ad67d; }

.ai-status-warn { color: #ffb347; }

.ai-status-error { color: #ff6b6b; }

.ai-status-off,
.ai-status-offline { color: var(--text-muted); }

.ai-status-pending { color: #9ec9ff; }

@media (max-width: 900px) {
  .ai-status-pill {
    font-size: .52rem;
    padding: 0;
  }
}

@media (max-width: 640px) {
  .ai-status-pill {
    margin-left: 0;
  }
}

/* ===== UNIFIED FINANCIAL PANEL ===== */
.unified-financial-panel {
  background: radial-gradient(circle at 15% 0%, rgba(255,179,71,0.12), transparent 45%),
    linear-gradient(135deg, #1b2430 0%, #121820 100%);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: var(--panel-radius);
  padding: 0.85rem 0.95rem 0.95rem;
  margin-bottom: var(--section-gap);
  box-shadow: 0 10px 20px -14px rgba(0,0,0,.65), 0 2px 6px rgba(0,0,0,.35);
  position: relative;
  overflow: hidden;
}

.unified-financial-panel::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: var(--panel-radius);
  background: radial-gradient(circle at 82% 12%, rgba(77,183,255,.14), transparent 55%);
  pointer-events: none;
}

.unified-financial-panel::after {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, rgba(255,179,71,0.85), rgba(90,214,125,0.85), rgba(77,183,255,0.85));
  opacity: 0.55;
  pointer-events: none;
}

.panel-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 0.75rem;
  margin-bottom: 0.75rem;
  position: relative;
  z-index: 1;
}

.panel-title-block {
  display: flex;
  flex-direction: column;
  gap: 0.2rem;
}

.panel-title {
  font-size: 0.82rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  font-weight: 700;
  color: #ffb347;
  margin: 0;
}

.panel-subtitle {
  font-size: 0.62rem;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: var(--text-muted);
  font-weight: 600;
}

.panel-meta {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 0.35rem 0.5rem;
  justify-content: flex-end;
}

.panel-count {
  font-size: 0.62rem;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: var(--text-muted);
  font-weight: 600;
}

.panel-badge {
  font-size: 0.56rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  font-weight: 700;
  color: #ffb347;
  border: 1px solid rgba(255,179,71,0.35);
  background: rgba(255,179,71,0.1);
  padding: 0.18rem 0.45rem;
  border-radius: 999px;
}

.panel-badge.warn {
  color: #ff6b6b;
  border-color: rgba(255,107,107,0.35);
  background: rgba(255,107,107,0.12);
}

/* Primary Metrics Grid (4 columns) */
.financial-grid {
  display: grid;
  gap: var(--card-gap);
  position: relative;
  z-index: 1;
}

.financial-grid.primary-row {
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  margin-bottom: 0.85rem;
}

.metric-card {
  background: linear-gradient(160deg, rgba(25,33,43,0.9) 0%, rgba(12,16,22,0.95) 100%);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: calc(var(--panel-radius) + 2px);
  padding: 0.75rem 0.8rem 0.8rem;
  display: flex;
  flex-direction: column;
  gap: 0.35rem;
  box-shadow: 0 6px 12px -8px rgba(0,0,0,.7), 0 1px 0 rgba(255,255,255,.02) inset;
  position: relative;
  transition: transform .25s ease, box-shadow .25s ease, border-color .25s ease;
}

.metric-card::before {
  content: "";
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  height: 2px;
  border-radius: calc(var(--panel-radius) + 2px) calc(var(--panel-radius) + 2px) 0 0;
  background: linear-gradient(90deg, rgba(255,179,71,0.9), rgba(77,183,255,0.4));
  opacity: 0.55;
}

.metric-card:hover {
  border-color: rgba(255,255,255,0.16);
  box-shadow: 0 10px 18px -12px rgba(0,0,0,.75), 0 1px 0 rgba(255,255,255,.04) inset;
  transform: translateY(-2px);
}

.metric-top {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.5rem;
}

.metric-label {
  font-size: 0.66rem;
  letter-spacing: 0.09em;
  text-transform: uppercase;
  font-weight: 700;
  color: var(--text-muted);
}

.metric-chip {
  font-size: 0.5rem;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  font-weight: 700;
  padding: 0.14rem 0.38rem;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.1);
  color: var(--text-base);
  background: rgba(255,255,255,0.06);
}

.metric-chip.positive {
  color: #5ad67d;
  border-color: rgba(90,214,125,0.3);
  background: rgba(90,214,125,0.12);
}

.metric-chip.negative {
  color: #ff6b6b;
  border-color: rgba(255,107,107,0.3);
  background: rgba(255,107,107,0.12);
}

.metric-chip.accent {
  color: #9d7ef7;
  border-color: rgba(157,126,247,0.3);
  background: rgba(157,126,247,0.12);
}

.metric-chip.neutral {
  color: #4db7ff;
  border-color: rgba(77,183,255,0.3);
  background: rgba(77,183,255,0.12);
}

.metric-value {
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--text-strong);
  font-variant-numeric: tabular-nums;
}

.metric-card.inflow-card .metric-value {
  color: #5ad67d;
}

.metric-card.outflow-card .metric-value {
  color: #ff6b6b;
}

.metric-card.net-card .metric-value {
  background: linear-gradient(90deg, #5ad67d 0%, #37b468 100%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}

.metric-card.average-card .metric-value {
  color: #9d7ef7;
}

.metric-foot {
  font-size: 0.58rem;
  letter-spacing: 0.04em;
  color: var(--text-muted);
  opacity: 0.75;
}

/* Secondary Stats Grid (5 columns) */
.financial-grid.secondary-row {
  grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
}

.stat-pill {
  background: rgba(15,20,26,0.8);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 999px;
  padding: 0.45rem 0.7rem;
  display: flex;
  flex-direction: column;
  gap: 0.2rem;
  text-align: center;
  transition: transform .2s ease, border-color .2s ease, box-shadow .2s ease;
}

.stat-pill:hover {
  border-color: rgba(255,255,255,0.16);
  box-shadow: 0 6px 12px -10px rgba(0,0,0,.65);
  transform: translateY(-1px);
}

.stat-label {
  font-size: .58rem;
  letter-spacing: .06em;
  text-transform: uppercase;
  font-weight: 700;
  color: var(--text-muted);
}

.stat-value {
  font-size: 0.95rem;
  font-weight: 700;
  color: var(--text-strong);
  font-variant-numeric: tabular-nums;
}

.stat-value.positive {
  color: #5ad67d;
}

.stat-value.negative {
  color: #ff6b6b;
}

.stat-pill.inflow-highlight {
  border-color: rgba(90,214,125,0.35);
  background: rgba(90,214,125,0.12);
}

.stat-pill.outflow-highlight {
  border-color: rgba(255,107,107,0.35);
  background: rgba(255,107,107,0.12);
}

.stat-pill.total-highlight {
  border-color: rgba(157,126,247,0.35);
  background: rgba(157,126,247,0.12);
}

/* Responsive Breakpoints */
@media (max-width: 1024px) {
  .financial-grid.primary-row {
    grid-template-columns: repeat(2, 1fr);
  }

  .financial-grid.secondary-row {
    grid-template-columns: repeat(3, 1fr);
  }
}

@media (max-width: 768px) {
  .unified-financial-panel {
    padding: 0.95rem;
    margin-bottom: var(--section-gap);
  }

  .financial-grid {
    gap: 0.6rem;
  }

  .financial-grid.primary-row {
    grid-template-columns: repeat(2, 1fr);
    margin-bottom: 1rem;
  }

  .metric-card {
    padding: 0.7rem;
  }

  .metric-value {
    font-size: 1.1rem;
  }
}

@media (max-width: 640px) {
  .unified-financial-panel {
    padding: 0.85rem;
  }

  .panel-title {
    font-size: 0.78rem;
  }

  .panel-subtitle,
  .panel-count {
    font-size: 0.58rem;
  }

  .financial-grid.primary-row {
    grid-template-columns: 1fr;
    margin-bottom: 0.8rem;
  }

  .financial-grid.secondary-row {
    grid-template-columns: repeat(2, 1fr);
  }

  .metric-card,
  .stat-pill {
    padding: 0.55rem 0.6rem;
  }

  .metric-value {
    font-size: 1rem;
  }

  .stat-value {
    font-size: 0.82rem;
  }
}

/* Consistent card surfaces across the dashboard */
.card,
.panel,
.recent-card,
.help-card,
.dev-card,
.settings-panel,
.sample-preview,
.use-cases,
.trust-badges,
.value-grid,
.value-grid.merged,
.table-wrapper,
.table-empty-message,
.filters.consolidated,
.categorize-cluster,
.upload-panel {
  background: var(--card-surface-bg);
  border: 1px solid var(--card-surface-border);
  border-radius: var(--panel-radius);
  box-shadow: var(--card-surface-shadow);
}
